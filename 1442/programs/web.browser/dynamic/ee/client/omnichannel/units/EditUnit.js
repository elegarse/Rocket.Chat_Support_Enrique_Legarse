function module(e,t,n){let l,a,r,i,o,s,m,c,d,u,p,h,E,v,b,f,x,_,k,g,w,M;function y(e){let{unitId:t,reload:n}=e;const l=i(()=>({unitId:t}),[t]),{data:a,state:o,error:s}=_("livechat/units.getOne",l),{data:m,state:c,error:d}=_("livechat/department"),{data:u,state:h,error:E}=_("livechat/monitors.list"),{data:v,state:b,error:x}=_("livechat/unitMonitors.list",l),w=f();return[o,c,h,b].includes(k.LOADING)?r.createElement(g,null):s||d||E||x?r.createElement(p,{m:"x16",type:"danger"},w("Not_Available")):r.createElement(D,{unitId:t,data:a,availableDepartments:m,availableMonitors:u,unitMonitors:v,reload:n})}function C(e){let{reload:t}=e;const n=f(),{data:l,state:a,error:i}=_("livechat/department"),{data:o,state:s,error:m}=_("livechat/monitors.list");return[a,s].includes(k.LOADING)?r.createElement(g,null):i||m?r.createElement(d,{mbs:"x16"},n("Not_found")):r.createElement(D,{reload:t,isNew:!0,availableDepartments:l,availableMonitors:o})}function D(e){let{data:t,unitId:n,isNew:p,availableDepartments:_,availableMonitors:k,unitMonitors:g,reload:y}=e,C=a(e,["data","unitId","isNew","availableDepartments","availableMonitors","unitMonitors","reload"]);const D=f(),I=M("omnichannel-units"),T=t||{},N=i(()=>_&&_.departments?_.departments.map(e=>{let{_id:t,name:n}=e;return[t,n||t]}):[],[_]),S=i(()=>k&&k.monitors?k.monitors.map(e=>{let{_id:t,name:n}=e;return[t,n||t]}):[],[k]),G=i(()=>g&&g.monitors?g.monitors.map(e=>{let{monitorId:t}=e;return t}):[],[g]),R=[["public",D("Public")],["private",D("Private")]],L=i(()=>_&&_.departments&&n?_.departments.map(e=>{let t;return e.parentId===n&&(t=e._id),t}).filter(e=>!!e):[],[_,n]),{values:q,handlers:U,hasUnsavedChanges:A}=w({name:T.name,visibility:T.visibility,departments:L,monitors:G}),{handleName:F,handleVisibility:O,handleDepartments:P,handleMonitors:W}=U,{name:B,visibility:V,departments:j,monitors:z}=q,H=i(()=>B&&0!==B.length?void 0:D("The_field_is_required","name"),[B,D]),J=i(()=>V&&0!==V.length?void 0:D("The_field_is_required","description"),[V,D]),K=i(()=>j&&0!==j.length?void 0:D("The_field_is_required","departments"),[j,D]),Q=i(()=>z&&0!==z.length?void 0:D("The_field_is_required","monitors"),[z,D]),X=v("livechat:saveUnit"),Y=b(),Z=E(()=>{y()}),$=i(()=>!H&&!J&&!K,[H,J,K]),ee=E(async()=>{const e={name:B,visibility:V},t=j.map(e=>({departmentId:e})),l=z.map(e=>{const t=S.find(t=>t[0]===e);return{monitorId:t[0],username:t[1]}});if(!$)return Y({type:"error",message:D("The_field_is_required")});try{await X(n,e,l,t),Y({type:"success",message:D("saved")}),y(),I.push({})}catch(a){Y({type:"error",message:a})}});return r.createElement(x.ScrollableContent,l({is:"form"},C),r.createElement(o,null,r.createElement(o.Label,null,D("Name")),r.createElement(o.Row,null,r.createElement(s,{flexGrow:1,value:B,onChange:F,error:A&&H}))),r.createElement(o,null,r.createElement(o.Label,null,D("Visibility")),r.createElement(o.Row,null,r.createElement(h,{options:R,value:V,error:A&&Q,placeholder:D("Select_an_option"),onChange:O,flexGrow:1}))),r.createElement(o,null,r.createElement(o.Label,null,D("Departments")),r.createElement(o.Row,null,r.createElement(u,{options:N,value:j,error:A&&K,maxWidth:"100%",placeholder:D("Select_an_option"),onChange:P,flexGrow:1}))),r.createElement(o,null,r.createElement(o.Label,null,D("Monitors")),r.createElement(o.Row,null,r.createElement(u,{options:S,value:z,error:A&&Q,maxWidth:"100%",placeholder:D("Select_an_option"),onChange:W,flexGrow:1}))),r.createElement(o.Row,null,r.createElement(d,{display:"flex",flexDirection:"row",justifyContent:"space-between",w:"full"},r.createElement(c,{inlineEnd:"x4"},!p&&r.createElement(m,{flexGrow:1,type:"reset",disabled:!A,onClick:Z},D("Reset")),r.createElement(m,{mie:"none",flexGrow:1,disabled:!A&&!$,onClick:ee},D("Save"))))))}n.link("@babel/runtime/helpers/extends",{default(e){l=e}},0),n.link("@babel/runtime/helpers/objectWithoutProperties",{default(e){a=e}},1),n.export({UnitEditWithData:()=>y,UnitNew:()=>C,UnitEdit:()=>D}),n.link("react",{default(e){r=e},useMemo(e){i=e}},0),n.link("@rocket.chat/fuselage",{Field(e){o=e},TextInput(e){s=e},Button(e){m=e},Margins(e){c=e},Box(e){d=e},MultiSelect(e){u=e},Callout(e){p=e},Select(e){h=e}},1),n.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){E=e}},2),n.link("../../../../client/contexts/ServerContext",{useMethod(e){v=e}},3),n.link("../../../../client/contexts/ToastMessagesContext",{useToastMessageDispatch(e){b=e}},4),n.link("../../../../client/contexts/TranslationContext",{useTranslation(e){f=e}},5),n.link("../../../../client/components/basic/VerticalBar",{default(e){x=e}},6),n.link("../../../../client/hooks/useEndpointDataExperimental",{useEndpointDataExperimental(e){_=e},ENDPOINT_STATES(e){k=e}},7),n.link("./Skeleton",{FormSkeleton(e){g=e}},8),n.link("../../../../client/hooks/useForm",{useForm(e){w=e}},9),n.link("../../../../client/contexts/RouterContext",{useRoute(e){M=e}},10)}

