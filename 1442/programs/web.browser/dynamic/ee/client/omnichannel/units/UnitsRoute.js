function module(e,t,n){let a,i,l,o,c,s,r,u,m,d,k,x,h,E,p,f,C,y,b,g,v,w,T,P,U;function D(e){let{_id:t,reload:n}=e;const a=E("livechat:removeUnit"),i=y("omnichannel-units"),c=P(),s=U(),r=x(),k=l(async()=>{try{await a(t)}catch(e){console.log(e)}i.push({}),n()}),h=l(e=>{e.stopPropagation();const t=async()=>{try{await k(),s({type:"success",message:r("Unit_removed")})}catch(e){s({type:"error",message:e})}c()};c(o.createElement(T,{onDelete:t,onCancel:()=>c()}))});return o.createElement(u.Cell,{fontScale:"p1",color:"hint",withTruncatedText:!0},o.createElement(d,{small:!0,ghost:!0,title:r("Remove"),onClick:h},o.createElement(m,{name:"trash",size:"x16"})))}n.link("@babel/runtime/helpers/objectSpread2",{default(e){a=e}},0),n.export({RemoveUnitButton:()=>D}),n.link("@rocket.chat/fuselage-hooks",{useDebouncedValue(e){i=e},useMutableCallback(e){l=e}},0),n.link("react",{default(e){o=e},useMemo(e){c=e},useCallback(e){s=e},useState(e){r=e}},1),n.link("@rocket.chat/fuselage",{Table(e){u=e},Icon(e){m=e},Button(e){d=e}},2),n.link("../../../../client/components/GenericTable",{Th(e){k=e}},3),n.link("../../../../client/contexts/TranslationContext",{useTranslation(e){x=e}},4),n.link("../../../../client/hooks/useEndpointDataExperimental",{useEndpointDataExperimental(e){h=e}},5),n.link("../../../../client/contexts/ServerContext",{useMethod(e){E=e}},6),n.link("../../../../client/contexts/AuthorizationContext",{usePermission(e){p=e}},7),n.link("../../../../client/components/NotAuthorizedPage",{default(e){f=e}},8),n.link("../../../../client/contexts/RouterContext",{useRouteParameter(e){C=e},useRoute(e){y=e}},9),n.link("../../../../client/components/basic/VerticalBar",{default(e){b=e}},10),n.link("./UnitsPage",{default(e){g=e}},11),n.link("./EditUnit",{UnitEditWithData(e){v=e},UnitNew(e){w=e}},12),n.link("../../../../client/omnichannel/DeleteWarningModal",{default(e){T=e}},13),n.link("../../../../client/contexts/ModalContext",{useSetModal(e){P=e}},14),n.link("../../../../client/contexts/ToastMessagesContext",{useToastMessageDispatch(e){U=e}},15);const M=e=>"asc"===e?1:-1,R=(e,t)=>{let{text:n,itemsPerPage:i,current:l}=e,[o,s]=t;return c(()=>a({fields:JSON.stringify({name:1}),text:n,sort:JSON.stringify({[o]:M(s),usernames:"name"===o?M(s):void 0})},i&&{count:i},{},l&&{offset:l}),[n,i,l,o,s])};function N(){const e=x(),t=p("manage-livechat-units"),[n,a]=r({text:"",current:0,itemsPerPage:25}),[m,d]=r(["name","asc"]),E=i(n,500),T=i(m,500),P=R(E,T),U=y("omnichannel-units"),M=C("context"),N=C("id"),S=l(e=>{const[t,n]=m;d(t!==e?[e,"asc"]:[e,"asc"===n?"desc":"asc"])}),_=l(e=>()=>U.push({context:"edit",id:e})),{data:B,reload:z}=h("livechat/units.list",P)||{},I=c(()=>[o.createElement(k,{key:"name",direction:m[1],active:"name"===m[0],onClick:S,sort:"name",w:"x120"},e("Name")),o.createElement(k,{key:"visibility",direction:m[1],active:"visibility"===m[0],onClick:S,sort:"visibility",w:"x200"},e("Visibility")),o.createElement(k,{key:"remove",w:"x40"},e("Remove"))].filter(Boolean),[m,S,e]),V=s(e=>{let{_id:t,name:n,visibility:a}=e;return(o.createElement(u.Row,{key:t,tabIndex:0,role:"link",onClick:_(t),action:!0,"qa-user-id":t},o.createElement(u.Cell,{withTruncatedText:!0},n),o.createElement(u.Cell,{withTruncatedText:!0},a),o.createElement(D,{_id:t,reload:z})))},[z,_]),A=s(()=>{if(!M)return"";const t=()=>{U.push({})};return(o.createElement(b,{className:"contextual-bar"},o.createElement(b.Header,null,"edit"===M&&e("Edit_Unit"),"new"===M&&e("New_Unit"),o.createElement(b.Close,{onClick:t})),"edit"===M&&o.createElement(v,{unitId:N,reload:z}),"new"===M&&o.createElement(w,{reload:z})))},[e,M,N,U,z]);return t?o.createElement(g,{setParams:a,params:n,onHeaderClick:S,data:B,useQuery:R,reload:z,header:I,renderRow:V,title:"Units"},o.createElement(A,null)):o.createElement(f,null)}n.exportDefault(N)}

