function module(e,t,n){let a,i,o,l,s,c,r,u,d,m,y,f,h,v,g;n.export({ActiveUsersSection:()=>k}),n.link("@nivo/line",{ResponsiveLine(e){a=e}},0),n.link("@rocket.chat/fuselage",{Box(e){i=e},Flex(e){o=e},Skeleton(e){l=e},Tile(e){s=e}},1),n.link("moment",{default(e){c=e}},2),n.link("react",{default(e){r=e},useMemo(e){u=e}},3),n.link("../../../../../../client/contexts/TranslationContext",{useTranslation(e){d=e}},4),n.link("../../../../../../client/hooks/useEndpointData",{useEndpointData(e){m=e}},5),n.link("../../../../../../client/components/data/CounterSet",{default(e){y=e}},6),n.link("../data/LegendSymbol",{LegendSymbol(e){f=e}},7),n.link("../Section",{Section(e){h=e}},8),n.link("../../../../../../client/components/basic/Buttons/ActionButton",{ActionButton(e){v=e}},9),n.link("../../../../../../client/lib/saveFile",{saveFile(e){g=e}},10);const p=e=>{let{countDailyActiveUsers:t,diffDailyActiveUsers:n,countWeeklyActiveUsers:a,diffWeeklyActiveUsers:i,countMonthlyActiveUsers:o,diffMonthlyActiveUsers:l,dauValues:s,wauValues:c,mauValues:r}=e;return"// countDailyActiveUsers, diffDailyActiveUsers, countWeeklyActiveUsers, diffWeeklyActiveUsers, countMonthlyActiveUsers, diffMonthlyActiveUsers, dauValues, wauValues, mauValues\n".concat(t,", ").concat(n,", ").concat(a,", ").concat(i,", ").concat(o,", ").concat(l,", ").concat(s,", ").concat(c,", ").concat(r)};function k(){const e=d(),t=u(()=>({start:c().set({hour:0,minute:0,second:0,millisecond:0}).subtract(30,"days"),end:c().set({hour:0,minute:0,second:0,millisecond:0}).subtract(1)}),[]),n=u(()=>({start:t.start.clone().subtract(30,"days").toISOString(),end:t.end.toISOString()}),[t]),k=m("engagement-dashboard/users/active-users",n),[A,U,E,b,x,S,D,F,_]=u(()=>{if(!k)return[];const e=e=>({x:c(t.start).add(e,"days").toDate(),y:0}),n=()=>Array.from({length:c(t.end).diff(t.start,"days")+1},(t,n)=>e(n)),a=(e,t,n,a,i)=>{for(let o=0;o<n;++o){const n=t+o;n>=a.length||(n>=0&&(a[n].y+=e),-1===n&&(i.y+=e))}},i=n(),o=e(-1),l=n(),s=e(-1),r=n(),u=e(-1);for(const{users:d,day:m,month:y,year:f}of k.month){const e=c.utc([f,y-1,m,0,0,0,0]).diff(t.start,"days");a(d,e,1,i,o),a(d,e,7,l,s),a(d,e,30,r,u)}return[i[i.length-1].y,i[i.length-1].y-o.y,l[l.length-1].y,l[l.length-1].y-s.y,r[r.length-1].y,r[r.length-1].y-u.y,i,l,r]},[t,k]),w=()=>{g(p({countDailyActiveUsers:A,diffDailyActiveUsers:U,countWeeklyActiveUsers:E,diffWeeklyActiveUsers:b,countMonthlyActiveUsers:x,diffMonthlyActiveUsers:S,dauValues:D,wauValues:F,mauValues:_}),"ActiveUsersSection_start_".concat(n.start,"_end_").concat(n.end,".csv"))};return r.createElement(h,{title:e("Active_users"),filter:r.createElement(v,{disabled:!k,onClick:w,"aria-label":e("Download_Info"),icon:"download"})},r.createElement(y,{counters:[{count:k?A:r.createElement(l,{variant:"rect",width:"3ex",height:"1em"}),variation:k?U:0,description:r.createElement(r.Fragment,null,r.createElement(f,{color:"#D1EBFE"})," ",e("Daily_Active_Users"))},{count:k?E:r.createElement(l,{variant:"rect",width:"3ex",height:"1em"}),variation:k?b:0,description:r.createElement(r.Fragment,null,r.createElement(f,{color:"#76B7FC"})," ",e("Weekly_Active_Users"))},{count:k?x:r.createElement(l,{variant:"rect",width:"3ex",height:"1em"}),variation:k?S:0,description:r.createElement(r.Fragment,null,r.createElement(f,{color:"#1D74F5"})," ",e("Monthly_Active_Users"))}]}),r.createElement(o.Container,null,k?r.createElement(i,{style:{height:240}},r.createElement(o.Item,{align:"stretch",grow:1,shrink:0},r.createElement(i,{style:{position:"relative"}},r.createElement(i,{style:{position:"absolute",width:"100%",height:"100%"}},r.createElement(a,{data:[{id:"dau",data:D},{id:"wau",data:F},{id:"mau",data:_}],xScale:{type:"time",format:"native",precision:"day"},xFormat:"time:%Y-%m-%d",yScale:{type:"linear",stacked:!0},enableGridX:!1,enableGridY:!1,enablePoints:!1,useMesh:!0,enableArea:!0,areaOpacity:1,enableCrosshair:!0,crosshairType:"bottom",margin:{top:0,bottom:20,right:0,left:40},colors:["#D1EBFE","#76B7FC","#1D74F5"],axisLeft:{tickSize:0,tickPadding:4,tickRotation:0,tickValues:3},axisBottom:{tickSize:0,tickPadding:4,tickRotation:0,tickValues:"every 3 days",format:e=>c(e).format(7===D.length?"dddd":"L")},animate:!0,motionStiffness:90,motionDamping:15,theme:{axis:{ticks:{text:{fill:"#9EA2A8",fontFamily:'Inter, -apple-system, system-ui, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Helvetica Neue", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Meiryo UI", Arial, sans-serif',fontSize:"10px",fontStyle:"normal",fontWeight:"600",letterSpacing:"0.2px",lineHeight:"12px"}}},tooltip:{container:{backgroundColor:"#1F2329",boxShadow:"0px 0px 12px rgba(47, 52, 61, 0.12), 0px 0px 2px rgba(47, 52, 61, 0.08)",borderRadius:2}}},enableSlices:"x",sliceTooltip:t=>{let{slice:{points:n}}=t;return(r.createElement(s,{elevation:"2"},n.map(t=>{let{serieId:n,data:{y:a}}=t;return(r.createElement(i,{key:n,fontScale:"p2"},"dau"===n&&e("DAU_value",{value:a})||"wau"===n&&e("WAU_value",{value:a})||"mau"===n&&e("MAU_value",{value:a})))})))}}))))):r.createElement(l,{variant:"rect",height:240})))}}

