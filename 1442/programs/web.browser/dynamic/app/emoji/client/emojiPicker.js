function module(e,t,o){let a,r,c,n,s,i,g,l;o.export({updateRecentEmoji:()=>h}),o.link("underscore",{default(e){a=e}},0),o.link("meteor/reactive-var",{ReactiveVar(e){r=e}},1),o.link("meteor/reactive-dict",{ReactiveDict(e){c=e}},2),o.link("meteor/kadira:flow-router",{FlowRouter(e){n=e}},3),o.link("meteor/templating",{Template(e){s=e}},4),o.link("../../utils/client",{t(e){i=e}},5),o.link("./lib/EmojiPicker",{EmojiPicker(e){g=e}},6),o.link("../lib/rocketchat",{emoji(e){l=e}},7),o.link("./emojiPicker.html"),o.link("../../theme/client/imports/components/emojiPicker.css");const p=27,m=new c("emojiList"),k=(e,t)=>t&&'<li class="emoji-'.concat(e,' emoji-picker-item" data-emoji="').concat(e,'" title="').concat(e,'">').concat(t,"</li>"),u=(e,t)=>{const o=Object.values(l.packages).map(o=>{if(o.emojisByCategory&&o.emojisByCategory[e])return o.emojisByCategory[e].map(e=>{const a=t>0&&o.toneList.hasOwnProperty(e)?"_tone".concat(t):"";return k(e,o.renderPicker(":".concat(e).concat(a,":")))}).join("")}).join("")||"<li>".concat(i("No_emojis_found"),"</li>");return o};function h(e){m.set(e,u(e))}const j=e=>{const t=e.categoriesList,o=e.tone;t.forEach(e=>m.set(e.key,u(e.key,o)))};function y(e){let t='<ul class="emoji-list">';const o=s.instance(),a=o.tone;g.currentCategory.set("");const r=new RegExp(RegExp.escape(e.replace(/:/g,"")),"i");for(let c in l.list)if(l.list.hasOwnProperty(c)&&r.test(c)){const o=l.list[c],{emojiPackage:r,shortnames:n=[]}=o;let s="";c=c.replace(/:/g,"");const i=void 0!==n[0]?n[0].replace(/:/g,""):n[0];a>0&&l.packages[r].toneList.hasOwnProperty(l)&&(s="_tone".concat(a));let g=!1;for(const t in l.packages[r].emojisByCategory)if(l.packages[r].emojisByCategory.hasOwnProperty(t)){const o=l.packages[r].emojisByCategory[t],a=void 0!==i?i.replace(/:/g,"").split("_"):i;if(-1!==o.indexOf(c)||void 0!==a&&a.includes(e)){g=!0;break}}if(g){const e=l.packages[r].renderPicker(":".concat(c).concat(s,":"));t+=k(c,e)}}return t+="</ul>"}s.emojiPicker.helpers({emojiCategories:()=>s.instance().categoriesList,emojiByCategory(e){let t=[];for(const o in l.packages)l.packages.hasOwnProperty(o)&&l.packages[o].emojisByCategory.hasOwnProperty(e)&&(t=t.concat(l.packages[o].emojisByCategory[e]));return t},searching:()=>s.instance().currentSearchTerm.get().length>0,searchResults:()=>y(s.instance().currentSearchTerm.get()),emojiList:e=>m.get(e),currentTone:()=>"tone-".concat(s.instance().tone),activeCategory:e=>g.currentCategory.get()===e?"active":"",currentCategory:()=>g.currentCategory.get()}),s.emojiPicker.events({"click .emoji-picker"(e){e.stopPropagation(),e.preventDefault()},"click .add-custom"(e){e.stopPropagation(),e.preventDefault(),n.go("/admin/emoji-custom"),g.close()},"click .category-link":e=>(e.stopPropagation(),e.preventDefault(),g.showCategory(e.currentTarget.hash.substr(1)),!1),"scroll .emojis":a.throttle((e,t)=>{if(g.scrollingToCategory)return;const o=t.$(e.currentTarget),a=o.scrollTop()+8,r=g.getCategoryPositions().filter(e=>e.top<=a).pop();if(!r)return;const{el:c}=r,n=c.id.replace("emoji-list-category-","");g.currentCategory.set(n)},300),"click .change-tone > a"(e,t){e.stopPropagation(),e.preventDefault(),t.$(".tone-selector").toggleClass("show")},"click .tone-selector .tone"(e,t){e.stopPropagation(),e.preventDefault();const o=parseInt(e.currentTarget.dataset.tone);let a;a=o>0?"_tone".concat(o):"";for(const r in l.packages)if(l.packages.hasOwnProperty(r)&&l.packages[r].hasOwnProperty("toneList"))for(const e in l.packages[r].toneList)l.packages[r].toneList.hasOwnProperty(e)&&$(".emoji-".concat(e)).html(l.packages[r].render(":".concat(e).concat(a,":")));g.setTone(o),t.setCurrentTone(o),$(".tone-selector").toggleClass("show")},"click .emoji-list .emoji-picker-item"(e,t){e.stopPropagation();const o=e.currentTarget.dataset.emoji,a=t.tone;let r="";for(const n in l.packages)l.packages.hasOwnProperty(n)&&a>0&&l.packages[n].toneList.hasOwnProperty(o)&&(r="_tone".concat(a));const c=$(".emoji-picker .js-emojipicker-search");c&&c.val(""),t.currentSearchTerm.set(""),g.pickEmoji(o+r)},"keyup .js-emojipicker-search, change .js-emojipicker-search"(e,t){if(e.preventDefault(),e.stopPropagation(),27===e.keyCode)return g.close();const o=e.target.value.trim(),a=t.currentSearchTerm;o!==a.get()&&a.set(o)}}),s.emojiPicker.onCreated((function(){this.tone=g.getTone();const e=g.getRecent();this.currentSearchTerm=new r(""),this.categoriesList=[];for(const t in l.packages)l.packages.hasOwnProperty(t)&&l.packages[t].emojiCategories&&(void 0!==l.packages[t].categoryIndex?this.categoriesList.splice(l.packages[t].categoryIndex,0,...l.packages[t].emojiCategories):this.categoriesList=this.categoriesList.concat(l.packages[t].emojiCategories));e.forEach(e=>{l.packages.base.emojisByCategory.recent.push(e)}),this.setCurrentTone=e=>{$(".current-tone").removeClass("tone-".concat(this.tone)),$(".current-tone").addClass("tone-".concat(e)),this.tone=e},j(this)}))}

