function module(e,t,a){let n,r,l,o,s,c,i,m,d,u,k,h,C,x,p,v,y,f,g,E,T,w;function S(e){let{_id:t,reload:a}=e;const n=v("livechat:removeRoom"),r=T(),s=w(),c=x(),i=l(async()=>{try{await n(t)}catch(e){console.log(e)}a()}),k=l(e=>{e.stopPropagation();const t=async()=>{try{await i(),s({type:"success",message:c("Chat_removed")})}catch(e){s({type:"error",message:e})}r()};r(o.createElement(E,{onDelete:t,onCancel:()=>r()}))});return o.createElement(m.Cell,{fontScale:"p1",color:"hint",withTruncatedText:!0},o.createElement(u,{small:!0,ghost:!0,title:c("Remove"),onClick:k},o.createElement(d,{name:"trash",size:"x16"})))}a.link("@babel/runtime/helpers/objectSpread2",{default(e){n=e}},0),a.export({RemoveChatButton:()=>S}),a.link("@rocket.chat/fuselage-hooks",{useDebouncedValue(e){r=e},useMutableCallback(e){l=e}},0),a.link("react",{default(e){o=e},useMemo(e){s=e},useCallback(e){c=e},useState(e){i=e}},1),a.link("@rocket.chat/fuselage",{Table(e){m=e},Icon(e){d=e},Button(e){u=e}},2),a.link("moment",{default(e){k=e}},3),a.link("meteor/kadira:flow-router",{FlowRouter(e){h=e}},4),a.link("../../components/GenericTable",{Th(e){C=e}},5),a.link("../../contexts/TranslationContext",{useTranslation(e){x=e}},6),a.link("../../hooks/useEndpointDataExperimental",{useEndpointDataExperimental(e){p=e}},7),a.link("../../contexts/ServerContext",{useMethod(e){v=e}},8),a.link("../../contexts/AuthorizationContext",{usePermission(e){y=e}},9),a.link("../../components/NotAuthorizedPage",{default(e){f=e}},10),a.link("./CurrentChatsPage",{default(e){g=e}},11),a.link("../DeleteWarningModal",{default(e){E=e}},12),a.link("../../contexts/ModalContext",{useSetModal(e){T=e}},13),a.link("../../contexts/ToastMessagesContext",{useToastMessageDispatch(e){w=e}},14);const b=e=>"asc"===e?1:-1,B=(e,t)=>{let{guest:a,servedBy:r,department:l,status:o,from:c,to:i,tags:m,customFields:d,itemsPerPage:u,current:k}=e,[h,C]=t;return s(()=>{const e=n({},a&&{roomName:a},{sort:JSON.stringify({[h]:b(C),ts:"ts"===h?b(C):void 0})},u&&{count:u},{},k&&{offset:k});return c&&i&&(e.createdAt=JSON.stringify({start:c,end:i})),"all"!==o&&(e.open="opened"===o),r&&"all"!==r&&(e.agents=[r]),l&&"all"!==l&&(e.departmentId=l),m&&m.length>0&&(e.tags=m),d&&Object.keys(d).length>0&&(e.customFields=JSON.stringify(d)),e},[a,h,C,u,k,c,i,o,r,l,m,d])};function M(){const e=x(),t=y("view-livechat-current-chats"),[a,n]=i({fname:"",servedBy:[],status:"",department:"",from:"",to:"",customFields:{},current:0,itemsPerPage:25}),[d,u]=i(["ts","desc"]),v=r(a,500),E=r(d,500),T=B(v,E),w=l(e=>{const[t,a]=d;u(t!==e?[e,"asc"]:[e,"asc"===a?"desc":"asc"])}),b=l(e=>{h.go("live",{id:e})}),{data:M,reload:P}=p("livechat/rooms",T)||{},D=s(()=>[o.createElement(C,{key:"name",direction:d[1],active:"name"===d[0],onClick:w,sort:"name",w:"x120"},e("Name")),o.createElement(C,{key:"departmentId",direction:d[1],active:"departmentId"===d[0],onClick:w,sort:"departmentId",w:"x200"},e("Department")),o.createElement(C,{key:"servedBy",direction:d[1],active:"servedBy"===d[0],onClick:w,sort:"servedBy",w:"x120"},e("Served_By")),o.createElement(C,{key:"ts",direction:d[1],active:"ts"===d[0],onClick:w,sort:"ts",w:"x120"},e("Started_At")),o.createElement(C,{key:"lm",direction:d[1],active:"lm"===d[0],onClick:w,sort:"visibility",w:"x120"},e("Last_Message")),o.createElement(C,{key:"status",direction:d[1],active:"status"===d[0],onClick:w,sort:"status",w:"x120"},e("Status")),o.createElement(C,{key:"remove",w:"x40"},e("Remove"))].filter(Boolean),[d,w,e]),R=c(t=>{let{_id:a,fname:n,servedBy:r,ts:l,lm:s,department:c,open:i}=t;return(o.createElement(m.Row,{key:a,tabIndex:0,role:"link",onClick:()=>b(a),action:!0,"qa-user-id":a},o.createElement(m.Cell,{withTruncatedText:!0},n),o.createElement(m.Cell,{withTruncatedText:!0},c?c.name:""),o.createElement(m.Cell,{withTruncatedText:!0},r&&r.username),o.createElement(m.Cell,{withTruncatedText:!0},k(l).format("L LTS")),o.createElement(m.Cell,{withTruncatedText:!0},k(s).format("L LTS")),o.createElement(m.Cell,{withTruncatedText:!0},e(i?"Open":"Closed")),!i&&o.createElement(S,{_id:a,reload:P})))},[b,P,e]);return t?o.createElement(g,{setParams:n,params:a,onHeaderClick:w,data:M,useQuery:B,reload:P,header:D,renderRow:R,title:"Current Chats"}):o.createElement(f,null)}a.exportDefault(M)}

