function module(e,t,a){let l,n,o,c,r,s,i,u,m,g,d,h,E,b,_,k,p,f,y;a.link("@babel/runtime/helpers/extends",{default(e){l=e}},0),a.link("react",{default(e){n=e},useState(e){o=e}},0),a.link("@rocket.chat/fuselage",{Box(e){c=e},Button(e){r=e},ButtonGroup(e){s=e},Field(e){i=e},FieldGroup(e){u=e},ToggleSwitch(e){m=e},Callout(e){g=e},Divider(e){d=e}},1),a.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){h=e}},2),a.link("../../components/basic/Page",{default(e){E=e}},3),a.link("../../components/PageSkeleton",{default(e){b=e}},4),a.link("../../contexts/TranslationContext",{useTranslation(e){_=e}},5),a.link("../../contexts/ToastMessagesContext",{useToastMessageDispatch(e){k=e}},6),a.link("../../contexts/ServerContext",{useMethodData(e){p=e},AsyncState(e){f=e},useMethod(e){y=e}},7);const x=[{action:"initialState"}],T=[{action:"list-pages"}],v=()=>{const e=_(),t=k(),[a,l,o]=p("livechat:facebook",x),[c,r,s]=p("livechat:facebook",T),{enabled:i,hasToken:u}=a||{enabled:!1,hasToken:!1},{pages:m}=c||{pages:[]},d=y("livechat:facebook"),v=h(async(e,a,l)=>{l(!a);try{const t=a?"unsubscribe":"subscribe";await d({action:t,page:e})}catch(n){t({type:"error",message:n}),l(a)}}),w=h(async()=>{try{await d({action:"disable"}),t({type:"success",message:e("Integration_disabled")}),o(),s()}catch(a){t({type:"error",message:a})}}),C=(e,t)=>{const a=window.open(e,"facebook-integration-oauth","width=600,height=400"),l=setInterval(()=>{(null==a?void 0:a.closed)&&(clearInterval(l),t())},300)},R=h(async()=>{try{const e=await d({action:"enable"});(null==e?void 0:e.url)?C(null==e?void 0:e.url,()=>{R()}):(o(),s())}catch(e){t({type:"error",message:e})}});return l===f.LOADING||r===f.LOADING?n.createElement(b,null):l===f.ERROR?n.createElement(E,null,n.createElement(E.Header,{title:e("Edit_Custom_Field")}),n.createElement(E.ScrollableContentWithShadow,null,n.createElement(g,{type:"danger"},e("Error")))):(i&&u&&r===f.ERROR&&R(),n.createElement(S,{pages:m,enabled:i,hasToken:u,onToggle:v,onRefresh:s,onDisable:w,onEnable:R}))},w=e=>{let{name:t,id:a,subscribed:l,onToggle:r,className:s}=e;const[u,g]=o(l),d=h(()=>r(a,u,g));return n.createElement(i,{className:s},n.createElement(c,{display:"flex",flexDirection:"row"},n.createElement(i.Label,null,t),n.createElement(i.Row,null,n.createElement(m,{checked:u,onChange:d}))))},C=e=>{let{pages:t,onToggle:a,className:o}=e;return(n.createElement(u,null,t.map(e=>n.createElement(w,l({key:e.id},e,{onToggle:a,className:o})))))},S=e=>{let{pages:t,enabled:a,hasToken:l,onToggle:o,onRefresh:i,onEnable:m,onDisable:g}=e;const h=_();return(n.createElement(E,null,n.createElement(E.Header,{title:h("Facebook")}),n.createElement(E.ScrollableContentWithShadow,null,n.createElement(c,{maxWidth:"x600",w:"full",alignSelf:"center"},!a&&n.createElement(n.Fragment,null,n.createElement(s,{stretch:!0,mb:"x8"},n.createElement(r,{primary:!0,onClick:m,disabled:!l},h("Enable"))),!l&&n.createElement(n.Fragment,null,n.createElement("p",null,h("You_have_to_set_an_API_token_first_in_order_to_use_the_integration")),n.createElement("p",null,h("Please_go_to_the_Administration_page_then_Livechat_Facebook")))),a&&n.createElement(n.Fragment,null,n.createElement(c,{fontScale:"h1",mbe:"x8"},h("Pages")),(null==t?void 0:t.length)?n.createElement(u,null,n.createElement(C,{pages:t,onToggle:o})):h("No_pages_yet_Try_hitting_Reload_Pages_button"),n.createElement(c,{w:"full",mb:"x16"},n.createElement(d,null)),n.createElement(s,{stretch:!0,vertical:!0},n.createElement(r,{onClick:i},h("Reload_Pages")),n.createElement(r,{danger:!0,onClick:g},h("Disable"))))))))};a.exportDefault(v)}

