function module(e,n,t){let l,o,a,r,i,c,s,m,d,u,E,h,y,p,f,R,w,x,b,C,g,_,v,k,A,P,M,O,S,G,D,T,j,N,L,I,F;t.link("@babel/runtime/helpers/objectWithoutProperties",{default(e){l=e}},0),t.link("@babel/runtime/helpers/objectSpread2",{default(e){o=e}},1),t.link("react",{default(e){a=e},useCallback(e){r=e},useMemo(e){i=e},useRef(e){c=e}},0),t.link("@rocket.chat/fuselage",{Field(e){s=e},TextInput(e){m=e},ToggleSwitch(e){d=e},MultiSelect(e){u=e},Accordion(e){E=e},Callout(e){h=e},NumberInput(e){y=e},FieldGroup(e){p=e},Button(e){f=e},ButtonGroup(e){R=e},Box(e){w=e},Icon(e){x=e},TextAreaInput(e){b=e}},1),t.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){C=e}},2),t.link("../../components/basic/VerticalBar",{default(e){g=e}},3),t.link("../../components/basic/RawText",{default(e){_=e}},4),t.link("../../components/basic/avatar/RoomAvatarEditor",{default(e){v=e}},5),t.link("../../components/DeleteChannelWarning",{default(e){k=e}},6),t.link("../../contexts/TranslationContext",{useTranslation(e){A=e}},7),t.link("../../hooks/useForm",{useForm(e){P=e}},8),t.link("../../../app/utils/client",{roomTypes(e){M=e},RoomSettingsEnum(e){O=e}},9),t.link("../../../app/lib/lib/MessageTypes",{MessageTypesValues(e){S=e}},10),t.link("../../contexts/ServerContext",{useMethod(e){G=e}},11),t.link("../../contexts/ModalContext",{useSetModal(e){D=e}},12),t.link("../../contexts/SettingsContext",{useSetting(e){T=e}},13),t.link("../../contexts/AuthorizationContext",{usePermission(e){j=e},useAtLeastOnePermission(e){N=e},useRole(e){L=e}},14),t.link("../../hooks/useEndpointAction",{useEndpointActionExperimental(e){I=e}},15),t.link("../hooks/useUserRoom",{useUserRoom(e){F=e}},16);const H={c:"Channels",p:"Groups",d:"DMs"},q=(e,n)=>{const{t:t,ro:l,archived:a,topic:r,description:c,announcement:s,joinCodeRequired:m,sysMes:d,encrypted:u,retention:E={}}=e,{retentionPolicyEnabled:h,maxAgeDefault:y}=n,p=T("RetentionPolicy_AppliesTo".concat(H[e.t])),f=T("RetentionPolicy_DoNotPrunePinned"),R=T("RetentionPolicy_FilesOnly");return i(()=>{var n,i,w;return o({roomName:"d"===t?e.usernames.join(" x "):M.getRoomName(t,o({type:t},e)),roomType:t,readOnly:!!l,reactWhenReadOnly:!1,archived:!!a,roomTopic:null!=r?r:"",roomDescription:null!=c?c:"",roomAnnouncement:null!=s?s:"",roomAvatar:void 0,joinCode:"",joinCodeRequired:!!m,systemMessages:Array.isArray(d)?d:[],hideSysMes:!!(null==d?void 0:d.length),encrypted:u},h&&{retentionEnabled:null!==(n=E.enabled)&&void 0!==n?n:p,retentionOverrideGlobal:!!E.overrideGlobal,retentionMaxAge:Math.min(E.maxAge,y)||y,retentionExcludePinned:null!==(i=E.excludePinned)&&void 0!==i?i:f,retentionFilesOnly:null!==(w=E.filesOnly)&&void 0!==w?w:R})},[s,a,c,f,R,m,y,E.enabled,E.excludePinned,E.filesOnly,E.maxAge,E.overrideGlobal,p,h,l,e,d,t,r,u])};function J(e){let{rid:n}=e;const t=F(n);return(a.createElement(B,{room:o({type:null==t?void 0:t.t},t)}))}const W=(e,n,t,l)=>(!e.default||l)&&("p"===e.t&&n||"c"===e.t&&t);function B(e){let{room:n}=e;const t=A(),F=D(),J=T("RetentionPolicy_Enabled"),B=T("RetentionPolicy_MaxAge_".concat(H[n.t]))||30,U=c({}),V=r(e=>{let{initialValue:n,value:t,key:l}=e;const{current:o}=U;JSON.stringify(n)!==JSON.stringify(t)?o[l]=t:delete o[l]},[]),{values:z,handlers:Y,hasUnsavedChanges:K,reset:Q,commit:X}=P(q(n,{retentionPolicyEnabled:J,maxAgeDefault:B}),V),Z=i(()=>S.map(e=>{let{key:n,i18nLabel:l}=e;return[n,t(l)]}),[t]),{roomName:$,roomType:ee,readOnly:ne,encrypted:te,roomAvatar:le,archived:oe,roomTopic:ae,roomDescription:re,roomAnnouncement:ie,reactWhenReadOnly:ce,joinCode:se,joinCodeRequired:me,systemMessages:de,hideSysMes:ue,retentionEnabled:Ee,retentionOverrideGlobal:he,retentionMaxAge:ye,retentionExcludePinned:pe,retentionFilesOnly:fe}=z,{handleJoinCode:Re,handleJoinCodeRequired:we,handleSystemMessages:xe,handleEncrypted:be,handleHideSysMes:Ce,handleRoomName:ge,handleReadOnly:_e,handleArchived:ve,handleRoomAvatar:ke,handleReactWhenReadOnly:Ae,handleRoomType:Pe,handleRoomTopic:Me,handleRoomDescription:Oe,handleRoomAnnouncement:Se,handleRetentionEnabled:Ge,handleRetentionOverrideGlobal:De,handleRetentionMaxAge:Te,handleRetentionExcludePinned:je,handleRetentionFilesOnly:Ne}=Y,[Le,Ie,Fe,He,qe,Je,We,Be,Ue,Ve,ze]=i(()=>{var e;const t=(null===(e=M.getConfig(n.t))||void 0===e?void 0:e.allowRoomSettingChange)||(()=>{});return[t(n,O.NAME),t(n,O.TOPIC),t(n,O.ANNOUNCEMENT),t(n,O.ARCHIVE_OR_UNARCHIVE),t(n,O.DESCRIPTION),t(n,O.TYPE),t(n,O.READ_ONLY),t(n,O.SYSTEM_MESSAGES),t(n,O.JOIN_CODE),t(n,O.REACT_WHEN_READ_ONLY),t(n,O.E2E)]},[n]),Ye=L("admin"),Ke=j("create-c"),Qe=j("create-p"),Xe=W(n,Ke,Qe,Ye),Ze=j("set-readonly",n._id),$e=j("set-react-when-readonly",n._id),en=j("edit-privileged-setting",n._id),nn=N(i(()=>["archive-room","unarchive-room"],[])),tn=j("delete-".concat(n.t)),ln=oe!==!!n.archived,on=n.archived?"unarchive":"archive",an=n.archived?"Room_has_been_unarchived":"Room_has_been_archived",rn=I("POST","rooms.saveRoomSettings",t("Room_updated_successfully")),cn=I("POST","rooms.changeArchivationState",t(an)),sn=C(async()=>{const e=U.current,{joinCodeRequired:t,hideSysMes:a}=e,r=l(e,["joinCodeRequired","hideSysMes"]),i=()=>rn(o({rid:n._id},r,{},se&&{joinCode:t?se:""},{},(r.systemMessages||!a)&&{systemMessages:a?de:[]})),c=()=>cn({rid:n._id,action:on});await Promise.all([K&&i(),ln&&c()].filter(Boolean)),U.current={},X()}),mn=G("eraseRoom"),dn=C(()=>{const e=()=>F(void 0),t=async()=>{await mn(n._id),e()};F(a.createElement(k,{onConfirm:t,onCancel:e}))}),un=C(()=>{Pe("p"===ee?"c":"p")}),En=C(e=>{Te(Math.max(1,Number(e.currentTarget.value)))});return a.createElement(g.ScrollableContent,{p:"0",is:"form",onSubmit:C(e=>e.preventDefault())},a.createElement(v,{room:n,roomAvatar:le,onChangeAvatar:ke}),a.createElement(s,null,a.createElement(s.Label,null,t("Name")),a.createElement(s.Row,null,a.createElement(m,{disabled:!Le,value:$,onChange:ge,flexGrow:1}))),qe&&a.createElement(s,null,a.createElement(s.Label,null,t("Description")),a.createElement(s.Row,null,a.createElement(b,{rows:4,value:re,onChange:Oe,flexGrow:1}))),Fe&&a.createElement(s,null,a.createElement(s.Label,null,t("Announcement")),a.createElement(s.Row,null,a.createElement(b,{rows:4,value:ie,onChange:Se,flexGrow:1}))),Ie&&a.createElement(s,null,a.createElement(s.Label,null,t("Topic")),a.createElement(s.Row,null,a.createElement(b,{rows:4,value:ae,onChange:Me,flexGrow:1}))),Je&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("Private")),a.createElement(s.Row,null,a.createElement(d,{disabled:!Xe,checked:"p"===ee,onChange:un}))),a.createElement(s.Hint,null,t("Just_invited_people_can_access_this_channel"))),We&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("Read_only")),a.createElement(s.Row,null,a.createElement(d,{disabled:!Ze,checked:ne,onChange:_e}))),a.createElement(s.Hint,null,t("Only_authorized_users_can_write_new_messages"))),Ve&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("React_when_read_only")),a.createElement(s.Row,null,a.createElement(d,{disabled:!$e,checked:ce,onChange:Ae}))),a.createElement(s.Hint,null,t("Only_authorized_users_can_write_new_messages"))),He&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("Archived")),a.createElement(s.Row,null,a.createElement(d,{disabled:!nn,checked:oe,onChange:ve})))),Ue&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("Password_to_access")),a.createElement(s.Row,null,a.createElement(d,{checked:me,onChange:we}))),a.createElement(s.Row,null,a.createElement(m,{disabled:!me,value:se,onChange:Re,placeholder:t("Reset_password"),flexGrow:1}))),Be&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("Hide_System_Messages")),a.createElement(s.Row,null,a.createElement(d,{checked:ue,onChange:Ce}))),a.createElement(s.Row,null,a.createElement(u,{options:Z,disabled:!ue,value:de,onChange:xe,placeholder:t("Select_an_option"),flexGrow:1}))),ze&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("Encrypted")),a.createElement(s.Row,null,a.createElement(d,{checked:te,onChange:be})))),J&&a.createElement(E,null,a.createElement(E.Item,{title:t("Prune")},a.createElement(p,null,a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("RetentionPolicyRoom_Enabled")),a.createElement(s.Row,null,a.createElement(d,{checked:Ee,onChange:Ge})))),a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("RetentionPolicyRoom_OverrideGlobal")),a.createElement(s.Row,null,a.createElement(d,{disabled:!Ee||!en,checked:he,onChange:De})))),he&&a.createElement(a.Fragment,null,a.createElement(h,{type:"danger"},a.createElement(_,null,t("RetentionPolicyRoom_ReadTheDocs"))),a.createElement(s,null,a.createElement(s.Label,null,t("RetentionPolicyRoom_MaxAge",{max:B})),a.createElement(s.Row,null,a.createElement(y,{value:ye,onChange:En,flexGrow:1}))),a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("RetentionPolicyRoom_ExcludePinned")),a.createElement(s.Row,null,a.createElement(d,{checked:pe,onChange:je})))),a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,t("RetentionPolicyRoom_FilesOnly")),a.createElement(s.Row,null,a.createElement(d,{checked:fe,onChange:Ne})))))))),a.createElement(s,null,a.createElement(s.Row,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",w:"full"},a.createElement(R,{stretch:!0,flexGrow:1},a.createElement(f,{type:"reset",disabled:!K,onClick:Q},t("Reset")),a.createElement(f,{flexGrow:1,disabled:!K,onClick:sn},t("Save")))))),a.createElement(s,null,a.createElement(s.Row,null,a.createElement(f,{flexGrow:1,primary:!0,danger:!0,disabled:!tn,onClick:dn},a.createElement(x,{name:"trash",size:"x16"}),t("Delete")))))}t.exportDefault(J)}

