function module(e,t,l){let a,n,s,o,r,c,i,m,u,d,E,h,_,p,g,b,f,C,k,x,v,y,M,T,w,S;function F(){const e=n(["\n\tcursor: pointer;\n"]);return F=function(){return e},e}l.link("@babel/runtime/helpers/objectSpread2",{default(e){a=e}},0),l.link("@babel/runtime/helpers/taggedTemplateLiteral",{default(e){n=e}},1),l.export({ExportMessages:()=>D}),l.link("react",{default(e){s=e},useState(e){o=e},useEffect(e){r=e},useMemo(e){c=e}},0),l.link("@rocket.chat/fuselage",{Field(e){i=e},TextInput(e){m=e},Select(e){u=e},ButtonGroup(e){d=e},Button(e){E=e},Box(e){h=e},Icon(e){_=e},Callout(e){p=e},FieldGroup(e){g=e}},1),l.link("@rocket.chat/css-in-js",{css(e){b=e}},2),l.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){f=e}},3),l.link("toastr",{default(e){C=e}},4),l.link("../../components/basic/VerticalBar",{default(e){k=e}},5),l.link("../../components/basic/AutoComplete",{UserAutoComplete(e){x=e}},6),l.link("../../contexts/TranslationContext",{useTranslation(e){v=e}},7),l.link("../../hooks/useForm",{useForm(e){y=e}},8),l.link("../hooks/useUserRoom",{useUserRoom(e){M=e}},9),l.link("../../contexts/ServerContext",{useEndpoint(e){T=e}},10),l.link("../../../app/utils",{roomTypes(e){w=e},isEmail(e){S=e}},11);const L=b(F()),R=e=>{let{onCancel:t,rid:l}=e;const n=v(),{values:o,handlers:r}=y({dateFrom:"",dateTo:"",format:"html"}),{dateFrom:h,dateTo:_,format:p}=o,{handleDateFrom:b,handleDateTo:f,handleFormat:k}=r,x=c(()=>[["html",n("HTML")],["json",n("JSON")]],[n]),M=T("POST","rooms.export"),w=async()=>{try{return await M(a({rid:l,type:"file"},h&&{dateFrom:new Date(h)},{},_&&{dateTo:new Date(_)},{format:p})),void C.success(n("Your_email_has_been_queued_for_sending"))}catch(e){C.error(n("Error"))}};return s.createElement(g,null,s.createElement(i,null,s.createElement(i.Label,null,n("Date_From")),s.createElement(i.Row,null,s.createElement(m,{type:"date",value:h,onChange:b}))),s.createElement(i,null,s.createElement(i.Label,null,n("Date_to")),s.createElement(i.Row,null,s.createElement(m,{type:"date",value:_,onChange:f}))),s.createElement(i,null,s.createElement(i.Label,null,n("Output_format")),s.createElement(i.Row,null,s.createElement(u,{value:p,onChange:k,placeholder:n("Format"),options:x}))),s.createElement(d,{stretch:!0,mb:"x12"},s.createElement(E,{onClick:t},n("Cancel")),s.createElement(E,{primary:!0,onClick:()=>w()},n("Export"))))},j=e=>{let{onCancel:t,rid:l}=e;const a=v(),n=M(l),c=n&&n.t&&w.getRoomName(n.t,n),[u,b]=o([]),[k,F]=o(),{values:R,handlers:j}=y({dateFrom:"",dateTo:"",toUsers:"",additionalEmails:"",subject:a("Mail_Messages_Subject",c)}),{toUsers:D,additionalEmails:U,subject:B}=R,N=f(e=>b(u.concat(e))),O=f(e=>b(u.filter(t=>t!==e))),A=f(()=>{b([]),$("#chat-window-".concat(l,".messages-box .message.selected")).removeClass("selected")});r(()=>{const e=$("#chat-window-".concat(l));$(".messages-box",e).addClass("selectable");const t=function(){const{id:e}=this;this.classList.contains("selected")?(this.classList.remove("selected"),O(e)):(this.classList.add("selected"),N(e))};return $(".messages-box .message",e).on("click",t),()=>{$(".messages-box",e).removeClass("selectable"),$(".messages-box .message",e).off("click",t).filter(".selected").removeClass("selected")}},[l]);const{handleToUsers:I,handleAdditionalEmails:P,handleSubject:q}=j,z=T("POST","rooms.export"),G=async()=>{if(0!==D.length||""!==U)if(""===U||S(U))if(0!==u.length){F(null);try{return await z({rid:l,type:"email",toUsers:[D],toEmails:U.split(","),subject:B,messages:u}),void C.success(a("Your_email_has_been_queued_for_sending"))}catch(e){C.error(a("Error"))}}else F(a("Mail_Message_No_messages_selected_select_all"));else F(a("Mail_Message_Invalid_emails",U));else F(a("Mail_Message_Missing_to"))};return s.createElement(g,null,s.createElement(i,null,s.createElement(p,{onClick:A,title:a("Messages selected"),type:u.length>0?"success":"info"},s.createElement("p",null,"".concat(u.length," Messages selected")),u.length>0&&s.createElement(h,{is:"p",className:L},a("Click here to clear the selection")),0===u.length&&s.createElement(h,{is:"p"},a("Click_the_messages_you_would_like_to_send_by_email")))),s.createElement(i,null,s.createElement(i.Label,null,a("To_users")),s.createElement(i.Row,null,s.createElement(x,{value:D,onChange:I}))),s.createElement(i,null,s.createElement(i.Label,null,a("To_additional_emails")),s.createElement(i.Row,null,s.createElement(m,{placeholder:a("Email_Placeholder_any"),value:U,onChange:P,addon:s.createElement(_,{name:"mail",size:"x20"})}))),s.createElement(i,null,s.createElement(i.Label,null,a("Subject")),s.createElement(i.Row,null,s.createElement(m,{value:B,onChange:q,addon:s.createElement(_,{name:"edit",size:"x20"})}))),k&&s.createElement(p,{type:"danger",title:k}),s.createElement(d,{stretch:!0,mb:"x12"},s.createElement(E,{onClick:t},a("Cancel")),s.createElement(E,{primary:!0,onClick:()=>G()},a("Send"))))},D=function e(t){let{rid:l,tabBar:a}=t;const n=v(),[r,m]=o("email"),d=c(()=>[["email",n("Send_via_email")],["file",n("Export_as_file")]],[n]);return s.createElement(k,null,s.createElement(k.Header,null,n("Export_Messages"),s.createElement(k.Close,{onClick:()=>a.close()})),s.createElement(k.ScrollableContent,null,s.createElement(g,null,s.createElement(i,null,s.createElement(i.Label,null,n("Method")),s.createElement(i.Row,null,s.createElement(u,{value:r,onChange:e=>m(e),placeholder:n("Type"),options:d})))),r&&"file"===r&&s.createElement(R,{rid:l,onCancel:()=>a.close()}),r&&"email"===r&&s.createElement(j,{rid:l,onCancel:()=>a.close()})))};l.exportDefault(D)}

