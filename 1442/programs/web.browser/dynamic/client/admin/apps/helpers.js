function module(e,r,t){let a,n,s,i,l;t.export({appEnabledStatuses:()=>o,apiCurlGetter:()=>p,handleInstallError:()=>u,handleAPIError:()=>d,warnStatusChange:()=>h,appButtonProps:()=>A,appStatusSpanProps:()=>_,formatPrice:()=>b,formatPricingPlan:()=>f}),t.link("@rocket.chat/apps-engine/definition/AppStatus",{AppStatus(e){a=e}},0),t.link("semver",{default(e){n=e}},1),t.link("toastr",{default(e){s=e}},2),t.link("../../../app/apps/lib/misc/Utilities",{Utilities(e){i=e}},3),t.link("../../../app/utils/client",{t(e){l=e}},4);const o=[a.AUTO_ENABLED,a.MANUALLY_ENABLED],c=[a.COMPILER_ERROR_DISABLED,a.ERROR_DISABLED,a.INVALID_SETTINGS_DISABLED,a.INVALID_LICENSE_DISABLED],p=e=>(r,t)=>{const a=t.examples[r]||{};return i.curl({url:e(t.computedPath),method:r,params:a.params,query:a.query,content:a.content,headers:a.headers}).split("\n")};function u(e){if(!e.xhr||!e.xhr.responseJSON)return;const{status:r,messages:t,error:a,payload:n=null}=e.xhr.responseJSON;let i;switch(r){case"storage_error":i=t.join("");break;case"compiler_error":i="There has been compiler errors. App cannot be installed";break;case"app_user_error":i=t.join(""),n&&n.username&&(i=l("Apps_User_Already_Exists",{username:n.username}));break;default:i=a||"There has been an error installing the app"}s.error(i)}const d=e=>{console.error(e);const r=e.xhr&&e.xhr.responseJSON&&e.xhr.responseJSON.error||e.message;s.error(r)},h=(e,r)=>{c.includes(r)?s.error(l("App_status_".concat(r)),e):s.info(l("App_status_".concat(r)),e)},A=e=>{let{installed:r,version:t,marketplaceVersion:a,isPurchased:s,price:i,purchaseType:l,subscriptionInfo:o}=e;const c=r&&t&&a&&n.lt(t,a);if(c)return{action:"update",icon:"reload",label:"Update"};if(r)return;const p=s;if(p)return{action:"install",label:"Install"};const u="subscription"===l&&!o.status;if(u)return{action:"purchase",label:"Trial"};const d=i>0;return d?{action:"purchase",label:"Buy"}:{action:"purchase",label:"Install"}},_=e=>{let{installed:r,status:t,subscriptionInfo:n}=e;if(!r)return;const s=c.includes(t);if(s)return{type:"failed",icon:"warning",label:t===a.INVALID_SETTINGS_DISABLED?"Config Needed":"Failed"};const i=o.includes(t);if(!i)return{type:"warning",icon:"warning",label:"Disabled"};const l=n&&"trialing"===n.status;return l?{icon:"checkmark-circled",label:"Trial period"}:{icon:"checkmark-circled",label:"Enabled"}},b=e=>"$".concat(Number.parseFloat(e).toFixed(2)),f=e=>{let{strategy:r,price:t,tiers:a=[]}=e;const{perUnit:n=!1}=Array.isArray(a)&&a.find(e=>e.price===t)||{},s=["Apps_Marketplace_pricingPlan",Array.isArray(a)&&a.length>0&&"startingAt",r,n&&"perUser"].filter(Boolean).join("_");return l(s,{price:b(t)})}}

