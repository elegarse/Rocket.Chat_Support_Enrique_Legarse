function module(e,t,a){let n,l,s,o,r,c,u,i,m,d,_,g,h,w,C,v,p,y,E,x,k,f,A,S,b,U;a.link("@babel/runtime/helpers/objectSpread2",{default(e){n=e}},0),a.link("@babel/runtime/helpers/objectWithoutProperties",{default(e){l=e}},1),a.link("@rocket.chat/fuselage",{ButtonGroup(e){s=e},Button(e){o=e},Box(e){r=e},Icon(e){c=e},PasswordInput(e){u=e},TextInput(e){i=e},Modal(e){m=e}},0),a.link("meteor/sha",{SHA256(e){d=e}},1),a.link("react",{default(e){_=e},useMemo(e){g=e},useState(e){h=e},useCallback(e){w=e}},2),a.link("../components/basic/Page",{default(e){C=e}},3),a.link("./AccountProfileForm",{default(e){v=e}},4),a.link("../components/ConfirmOwnerChangeWarningModal",{default(e){p=e}},5),a.link("../contexts/TranslationContext",{useTranslation(e){y=e}},6),a.link("../hooks/useForm",{useForm(e){E=e}},7),a.link("../contexts/SettingsContext",{useSetting(e){x=e}},8),a.link("../contexts/UserContext",{useUser(e){k=e}},9),a.link("../contexts/ToastMessagesContext",{useToastMessageDispatch(e){f=e}},10),a.link("../contexts/ServerContext",{useMethod(e){A=e}},11),a.link("../contexts/ModalContext",{useSetModal(e){S=e}},12),a.link("../hooks/useUpdateAvatar",{useUpdateAvatar(e){b=e}},13),a.link("../helpers/getUserEmailAddress",{getUserEmailAddress(e){U=e}},14);const P=e=>{let{onSave:t,onCancel:a,title:n,text:d,isPassword:g}=e,C=l(e,["onSave","onCancel","title","text","isPassword"]);const v=y(),[p,E]=h(""),x=w(e=>E(e.currentTarget.value),[E]),k=w(()=>{t(p),a()},[p,t,a]);return _.createElement(m,C,_.createElement(m.Header,null,_.createElement(c,{color:"danger",name:"modal-warning",size:20}),_.createElement(m.Title,null,n),_.createElement(m.Close,{onClick:a})),_.createElement(m.Content,{fontScale:"p1"},_.createElement(r,{mb:"x8"},d),g&&_.createElement(u,{w:"full",value:p,onChange:x}),!g&&_.createElement(i,{w:"full",value:p,onChange:x})),_.createElement(m.Footer,null,_.createElement(s,{align:"end"},_.createElement(o,{ghost:!0,onClick:a},v("Cancel")),_.createElement(o,{primary:!0,danger:!0,onClick:k},v("Continue")))))},T=e=>{var t,a,n,l,s,o,r,c,u;return{realname:null!==(t=e.name)&&void 0!==t?t:"",email:null!==(a=U(e))&&void 0!==a?a:"",username:null!==(n=e.username)&&void 0!==n?n:"",password:"",confirmationPassword:"",avatar:"",url:null!==(l=e.avatarUrl)&&void 0!==l?l:"",statusText:null!==(s=e.statusText)&&void 0!==s?s:"",statusType:null!==(o=e.status)&&void 0!==o?o:"",bio:null!==(r=e.bio)&&void 0!==r?r:"",customFields:null!==(c=e.customFields)&&void 0!==c?c:{},nickname:null!==(u=e.nickname)&&void 0!==u?u:""}},F=()=>{var e,t,a;const l=y(),u=f(),i=k(),{values:m,handlers:F,hasUnsavedChanges:M,commit:O}=E(T(i)),[D,R]=h(!0),B=S(),[N,W]=h(!1),I=A("logoutOtherClients"),L=A("deleteUserOwnAccount"),H=A("saveUserProfile"),j=w(()=>B(null),[B]),q=Boolean(null==i?void 0:null===(e=i.services)||void 0===e?void 0:null===(t=e.password)||void 0===t?void 0:null===(a=t.bcrypt)||void 0===a?void 0:a.trim()),z=(m.email!==U(i)||!!m.password)&&q,G=x("Message_ErasureType"),V=x("Accounts_AllowRealNameChange"),$=x("Accounts_AllowUserStatusMessageChange"),J=x("Accounts_AllowUsernameChange"),K=x("Accounts_AllowEmailChange"),Q=x("Accounts_AllowPasswordChange"),X=x("Accounts_AllowUserAvatarChange"),Y=x("Accounts_AllowDeleteOwnAccount"),Z=x("LDAP_Enable"),ee=x("Accounts_RequireNameForSignUp"),te=x("UTF8_Names_Validation"),ae=g(()=>new RegExp("^".concat(te,"$")),[te]),ne=J&&!Z,le=g(()=>({allowRealNameChange:V,allowUserStatusMessageChange:$,allowEmailChange:K,allowPasswordChange:Q,allowUserAvatarChange:X,allowDeleteOwnAccount:Y,canChangeUsername:ne,requireName:ee,namesRegex:ae}),[Y,K,Q,V,X,$,ne,ee,ae]),{realname:se,email:oe,avatar:re,username:ce,password:ue,statusText:ie,statusType:me,customFields:de,bio:_e,nickname:ge}=m,{handleAvatar:he}=F,we=b(re,i._id),Ce=w(async()=>{const e=async e=>{try{const t=await we();t&&he(""),await H(n({},V&&{realname:se},{},K&&U(i)!==oe&&{email:oe},{},Q&&{password:ue},{},ne&&{username:ce},{},$&&{statusText:ie},{},e&&{typedPassword:d(e)},{statusType:me,nickname:ge,bio:_e||""}),de),O(),u({type:"success",message:l("Profile_saved_successfully")})}catch(t){u({type:"error",message:t})}};if(z)return B(()=>_.createElement(P,{onSave:e,onCancel:j,title:l("Please_enter_your_password"),text:l("For_your_security_you_must_enter_your_current_password_to_continue"),isPassword:!0}));e()},[H,K,Q,V,$,_e,ne,oe,ue,se,ie,ce,i,we,he,j,z,u,l,de,me,B,O,ge]),ve=w(async()=>{W(!0);try{await I(),u({type:"success",message:l("Logged_out_of_other_clients_successfully")})}catch(e){u({type:"error",message:e})}W(!1)},[I,u,l]),pe=w(async()=>{const e=async e=>{try{await L(d(e)),u({type:"success",message:l("User_has_been_deleted")})}catch(t){if("user-last-owner"===t.error){const{shouldChangeOwner:a,shouldBeRemoved:n}=t.details;return B(()=>_.createElement(p,{onConfirm:()=>{L(d(e),!0)},onCancel:j,contentTitle:l("Delete_User_Warning_".concat(G)),confirmLabel:l("Continue"),shouldChangeOwner:a,shouldBeRemoved:n}))}u({type:"error",message:t})}},t=l("Are_you_sure_you_want_to_delete_your_account");return B(q?()=>_.createElement(P,{onSave:e,onCancel:j,title:t,text:l("For_your_security_you_must_enter_your_current_password_to_continue"),isPassword:!0}):()=>_.createElement(P,{onSave:e,onCancel:j,title:t,text:l("If_you_are_sure_type_in_your_username"),isPassword:!0}))},[j,L,u,G,q,l,B]);return _.createElement(C,null,_.createElement(C.Header,{title:l("Profile")},_.createElement(s,null,_.createElement(o,{primary:!0,disabled:!M||!D||N,onClick:Ce},l("Save_changes")))),_.createElement(C.ScrollableContentWithShadow,null,_.createElement(r,{maxWidth:"600px",w:"full",alignSelf:"center"},_.createElement(v,{values:m,handlers:F,user:i,settings:le,onSaveStateChange:R}),_.createElement(s,{stretch:!0,mb:"x12"},_.createElement(o,{onClick:ve,flexGrow:0,disabled:N},l("Logout_Others")),Y&&_.createElement(o,{danger:!0,onClick:pe},_.createElement(c,{name:"trash",size:"x20",mie:"x4"}),l("Delete_my_account"))))))};a.exportDefault(F)}

