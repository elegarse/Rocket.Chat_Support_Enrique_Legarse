function module(e,t,n){var r,i,a,l,o,u,c,s,m,d,f,p,v,h,b,E,x,_,k,g,w,M,C;function y(e){var t=e.unitId,n=e.reload,r=o((function(){return{unitId:t}}),[t]),i=k("livechat/units.getOne",r),a=i.data,u=i.state,c=i.error,s=k("livechat/department"),m=s.data,d=s.state,f=s.error,v=k("livechat/monitors.list"),h=v.data,b=v.state,E=v.error,_=k("livechat/unitMonitors.list",r),M=_.data,C=_.state,y=_.error,D=x();return[u,d,b,C].includes(g.LOADING)?l.createElement(w,null):c||f||E||y?l.createElement(p,{m:"x16",type:"danger"},D("Not_Available")):l.createElement(I,{unitId:t,data:a,availableDepartments:m,availableMonitors:h,unitMonitors:M,reload:n})}function D(e){var t=e.reload,n=x(),r=k("livechat/department"),i=r.data,a=r.state,o=r.error,u=k("livechat/monitors.list"),c=u.data,s=u.state,m=u.error;return[a,s].includes(g.LOADING)?l.createElement(w,null):o||m?l.createElement(d,{mbs:"x16"},n("Not_found")):l.createElement(I,{reload:t,isNew:!0,availableDepartments:i,availableMonitors:c})}function I(e){var t=e.data,n=e.unitId,p=e.isNew,k=e.availableDepartments,g=e.availableMonitors,w=e.unitMonitors,y=e.reload,D=a(e,["data","unitId","isNew","availableDepartments","availableMonitors","unitMonitors","reload"]),I=x(),T=C("omnichannel-units"),N=t||{},S=o((function(){return k&&k.departments?k.departments.map((function(e){var t=e._id,n;return[t,e.name||t]})):[]}),[k]),G=o((function(){return g&&g.monitors?g.monitors.map((function(e){var t=e._id,n;return[t,e.name||t]})):[]}),[g]),R=o((function(){return w&&w.monitors?w.monitors.map((function(e){var t;return e.monitorId})):[]}),[w]),L=[["public",I("Public")],["private",I("Private")]],q=o((function(){return k&&k.departments&&n?k.departments.map((function(e){var t;return e.parentId===n&&(t=e._id),t})).filter((function(e){return!!e})):[]}),[k,n]),P=M({name:N.name,visibility:N.visibility,departments:q,monitors:R}),U=P.values,A=P.handlers,F=P.hasUnsavedChanges,O=A.handleName,W=A.handleVisibility,B=A.handleDepartments,V=A.handleMonitors,j=U.name,z=U.visibility,H=U.departments,J=U.monitors,K=o((function(){return j&&0!==j.length?void 0:I("The_field_is_required","name")}),[j,I]),Q=o((function(){return z&&0!==z.length?void 0:I("The_field_is_required","description")}),[z,I]),X=o((function(){return H&&0!==H.length?void 0:I("The_field_is_required","departments")}),[H,I]),Y=o((function(){return J&&0!==J.length?void 0:I("The_field_is_required","monitors")}),[J,I]),Z=b("livechat:saveUnit"),$=E(),ee=h((function(){y()})),te=o((function(){return!K&&!Q&&!X}),[K,Q,X]),ne=h(function(){function e(){var e,t,r;return i.async(function(){function a(a){for(;;)switch(a.prev=a.next){case 0:if(e={name:j,visibility:z},t=H.map((function(e){return{departmentId:e}})),r=J.map((function(e){var t=G.find((function(t){return t[0]===e}));return{monitorId:t[0],username:t[1]}})),te){a.next=5;break}return a.abrupt("return",$({type:"error",message:I("The_field_is_required")}));case 5:return a.prev=5,a.next=8,i.awrap(Z(n,e,r,t));case 8:$({type:"success",message:I("saved")}),y(),T.push({}),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(5),$({type:"error",message:a.t0});case 16:case"end":return a.stop()}}return a}(),null,null,[[5,13]],Promise)}return e}());return l.createElement(_.ScrollableContent,r({is:"form"},D),l.createElement(u,null,l.createElement(u.Label,null,I("Name")),l.createElement(u.Row,null,l.createElement(c,{flexGrow:1,value:j,onChange:O,error:F&&K}))),l.createElement(u,null,l.createElement(u.Label,null,I("Visibility")),l.createElement(u.Row,null,l.createElement(v,{options:L,value:z,error:F&&Y,placeholder:I("Select_an_option"),onChange:W,flexGrow:1}))),l.createElement(u,null,l.createElement(u.Label,null,I("Departments")),l.createElement(u.Row,null,l.createElement(f,{options:S,value:H,error:F&&X,maxWidth:"100%",placeholder:I("Select_an_option"),onChange:B,flexGrow:1}))),l.createElement(u,null,l.createElement(u.Label,null,I("Monitors")),l.createElement(u.Row,null,l.createElement(f,{options:G,value:J,error:F&&Y,maxWidth:"100%",placeholder:I("Select_an_option"),onChange:V,flexGrow:1}))),l.createElement(u.Row,null,l.createElement(d,{display:"flex",flexDirection:"row",justifyContent:"space-between",w:"full"},l.createElement(m,{inlineEnd:"x4"},!p&&l.createElement(s,{flexGrow:1,type:"reset",disabled:!F,onClick:ee},I("Reset")),l.createElement(s,{mie:"none",flexGrow:1,disabled:!F&&!te,onClick:ne},I("Save"))))))}n.link("@babel/runtime/helpers/extends",{default:function(e){r=e}},0),n.link("@babel/runtime/regenerator",{default:function(e){i=e}},1),n.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){a=e}},2),n.export({UnitEditWithData:function(){return y},UnitNew:function(){return D},UnitEdit:function(){return I}}),n.link("react",{default:function(e){l=e},useMemo:function(e){o=e}},0),n.link("@rocket.chat/fuselage",{Field:function(e){u=e},TextInput:function(e){c=e},Button:function(e){s=e},Margins:function(e){m=e},Box:function(e){d=e},MultiSelect:function(e){f=e},Callout:function(e){p=e},Select:function(e){v=e}},1),n.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(e){h=e}},2),n.link("../../../../client/contexts/ServerContext",{useMethod:function(e){b=e}},3),n.link("../../../../client/contexts/ToastMessagesContext",{useToastMessageDispatch:function(e){E=e}},4),n.link("../../../../client/contexts/TranslationContext",{useTranslation:function(e){x=e}},5),n.link("../../../../client/components/basic/VerticalBar",{default:function(e){_=e}},6),n.link("../../../../client/hooks/useEndpointDataExperimental",{useEndpointDataExperimental:function(e){k=e},ENDPOINT_STATES:function(e){g=e}},7),n.link("./Skeleton",{FormSkeleton:function(e){w=e}},8),n.link("../../../../client/hooks/useForm",{useForm:function(e){M=e}},9),n.link("../../../../client/contexts/RouterContext",{useRoute:function(e){C=e}},10)}

