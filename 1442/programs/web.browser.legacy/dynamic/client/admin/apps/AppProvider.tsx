function module(n,e,t){var r,a,u,i,o,c,s,l,f,p,d,v,m;t.link("@babel/runtime/helpers/toConsumableArray",{default:function(n){r=n}},0),t.link("@babel/runtime/regenerator",{default:function(n){a=n}},1),t.link("@babel/runtime/helpers/objectSpread2",{default:function(n){u=n}},2),t.link("@babel/runtime/helpers/createForOfIteratorHelperLoose",{default:function(n){i=n}},3),t.link("@babel/runtime/helpers/slicedToArray",{default:function(n){o=n}},4),t.export({AppDataContext:function(){return h}}),t.link("react",{default:function(n){c=n},createContext:function(n){s=n},useEffect:function(n){l=n},useRef:function(n){f=n},useState:function(n){p=n}},0),t.link("../../../app/apps/client/orchestrator",{Apps:function(n){d=n}},1),t.link("../../../app/apps/client/communication",{AppEvents:function(n){v=n}},2),t.link("./helpers",{handleAPIError:function(n){m=n}},3);var h=s({data:[],dataCache:[],finishedLoading:!1}),A=function(n){for(var e=Object.entries(n),t=0,r=e;t<r.length;t++){var a,u=r[t],c=o(u,2),s=c[0],l=c[1];null===(a=d.getWsListener())||void 0===a||a.registerListener(v[s],l)}return function(){for(var n=i(e),t;!(t=n()).done;){var r,a=t.value,u=o(a,2),c=u[0],s=u[1];null===(r=d.getWsListener())||void 0===r||r.unregisterListener(v[c],s)}}},b=function(n){var e=n.children,t=p((function(){return[]})),i=o(t,2),s=i[0],v=i[1],b=p((function(){return!1})),k=o(b,2),P=k[0],g=k[1],x=p((function(){return[]})),E=o(x,2),I=E[0],D=E[1],L=f(s);L.current=s;var w=function(){D((function(){return[]}))},C=function(){return L.current.slice(0)};return l((function(){var n=function(n){v(n.sort((function(n,e){return n.name.toLowerCase()>e.name.toLowerCase()?1:-1}))),w()},e=function(){function n(n){var e,t,r,i,o,c;return a.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,a.awrap(d.getApp(n));case 3:return e=s.sent,t=e.status,r=e.version,s.next=8,a.awrap(d.getAppFromMarketplace(n,r));case 8:i=s.sent,o=C(),c=o.findIndex((function(e){var t;return e.id===n})),o[c]=u({},i,{installed:!0,status:t,version:r,marketplaceVersion:i.version}),v(o),w(),s.next=19;break;case 16:s.prev=16,s.t0=s.catch(0),m(s.t0);case 19:case"end":return s.stop()}}return s}(),null,null,[[0,16]],Promise)}return n}(),t,i=A({APP_ADDED:e,APP_UPDATED:e,APP_REMOVED:function(n){var e=C(),t=e.findIndex((function(e){var t;return e.id===n}));e[t]&&(!1!==e[t].marketplace?e.splice(t,1):(delete e[t].installed,delete e[t].status,e[t].version=e[t].marketplaceVersion),v(e),w())},APP_STATUS_CHANGE:function(n){var e=n.appId,t=n.status,r=C(),a=r.find((function(n){var t;return n.id===e}));a&&(a.status=t,v(r),w())},APP_SETTING_UPDATED:function(){w()}});return function(){function e(){var e,t,o;return a.async(function(){function c(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,a.awrap(d.getApps().then((function(e){var t=[];return e.length&&(t=e.map((function(n){return u({},n,{installed:!0,marketplace:!1})})),n(t)),t})));case 3:return e=c.sent,c.next=6,a.awrap(d.getAppsFromMarketplace());case 6:t=c.sent,o=t.length?t.map((function(n){var t=e.findIndex((function(e){var t;return e.id===n.id}));if(!e[t])return u({},n,{status:void 0,marketplaceVersion:n.version,bundledIn:n.bundledIn});var r=e.splice(t,1).pop();return u({},n,{installed:!0,status:null==r?void 0:r.status,version:null==r?void 0:r.version,bundledIn:n.bundledIn,marketplaceVersion:n.version})})):[],e.length&&o.push.apply(o,r(e)),n(o),g(!0),c.next=17;break;case 13:c.prev=13,c.t0=c.catch(0),m(c.t0),i();case 17:case"end":return c.stop()}}return c}(),null,null,[[0,13]],Promise)}return e}()(),i}),[v,g]),c.createElement(h.Provider,{children:e,value:{data:s,dataCache:I,finishedLoading:P}})};t.exportDefault(b)}

