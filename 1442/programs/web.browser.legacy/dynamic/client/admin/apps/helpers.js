function module(r,e,n){var t,a,i,s,o;n.export({appEnabledStatuses:function(){return l},apiCurlGetter:function(){return c},handleInstallError:function(){return p},handleAPIError:function(){return f},warnStatusChange:function(){return d},appButtonProps:function(){return h},appStatusSpanProps:function(){return A},formatPrice:function(){return _},formatPricingPlan:function(){return b}}),n.link("@rocket.chat/apps-engine/definition/AppStatus",{AppStatus:function(r){t=r}},0),n.link("semver",{default:function(r){a=r}},1),n.link("toastr",{default:function(r){i=r}},2),n.link("../../../app/apps/lib/misc/Utilities",{Utilities:function(r){s=r}},3),n.link("../../../app/utils/client",{t:function(r){o=r}},4);var l=[t.AUTO_ENABLED,t.MANUALLY_ENABLED],u=[t.COMPILER_ERROR_DISABLED,t.ERROR_DISABLED,t.INVALID_SETTINGS_DISABLED,t.INVALID_LICENSE_DISABLED],c=function(r){return function(e,n){var t=n.examples[e]||{};return s.curl({url:r(n.computedPath),method:e,params:t.params,query:t.query,content:t.content,headers:t.headers}).split("\n")}};function p(r){if(r.xhr&&r.xhr.responseJSON){var e=r.xhr.responseJSON,n=e.status,t=e.messages,a=e.error,s=e.payload,l=void 0===s?null:s,u;switch(n){case"storage_error":u=t.join("");break;case"compiler_error":u="There has been compiler errors. App cannot be installed";break;case"app_user_error":u=t.join(""),l&&l.username&&(u=o("Apps_User_Already_Exists",{username:l.username}));break;default:u=a||"There has been an error installing the app"}i.error(u)}}var f=function(r){console.error(r);var e=r.xhr&&r.xhr.responseJSON&&r.xhr.responseJSON.error||r.message;i.error(e)},d=function(r,e){u.includes(e)?i.error(o("App_status_"+e),r):i.info(o("App_status_"+e),r)},h=function(r){var e=r.installed,n=r.version,t=r.marketplaceVersion,i=r.isPurchased,s=r.price,o=r.purchaseType,l=r.subscriptionInfo,u,c,p,f;return e&&n&&t&&a.lt(n,t)?{action:"update",icon:"reload",label:"Update"}:e?void 0:i?{action:"install",label:"Install"}:"subscription"!==o||l.status?s>0?{action:"purchase",label:"Buy"}:{action:"purchase",label:"Install"}:{action:"purchase",label:"Trial"}},A=function(r){var e=r.installed,n=r.status,a=r.subscriptionInfo,i,s,o;if(e)return u.includes(n)?{type:"failed",icon:"warning",label:n===t.INVALID_SETTINGS_DISABLED?"Config Needed":"Failed"}:l.includes(n)?a&&"trialing"===a.status?{icon:"checkmark-circled",label:"Trial period"}:{icon:"checkmark-circled",label:"Enabled"}:{type:"warning",icon:"warning",label:"Disabled"}},_=function(r){return"$"+Number.parseFloat(r).toFixed(2)},b=function(r){var e=r.strategy,n=r.price,t=r.tiers,a=void 0===t?[]:t,i,s=(Array.isArray(a)&&a.find((function(r){return r.price===n}))||{}).perUnit,l=void 0!==s&&s,u=["Apps_Marketplace_pricingPlan",Array.isArray(a)&&a.length>0&&"startingAt",e,l&&"perUser"].filter(Boolean).join("_");return o(u,{price:_(n)})}}

