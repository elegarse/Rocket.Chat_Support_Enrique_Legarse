function module(e,n,t){var r,a,o,s,l,u,c,i,m,f,d,_,p,v,h,g,w,x,C,k,y,b,E,A,P,S,U,T;t.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),t.link("@babel/runtime/helpers/objectSpread2",{default:function(e){a=e}},1),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){o=e}},2),t.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){s=e}},3),t.link("@rocket.chat/fuselage",{ButtonGroup:function(e){l=e},Button:function(e){u=e},Box:function(e){c=e},Icon:function(e){i=e},PasswordInput:function(e){m=e},TextInput:function(e){f=e},Modal:function(e){d=e}},0),t.link("meteor/sha",{SHA256:function(e){_=e}},1),t.link("react",{default:function(e){p=e},useMemo:function(e){v=e},useState:function(e){h=e},useCallback:function(e){g=e}},2),t.link("../components/basic/Page",{default:function(e){w=e}},3),t.link("./AccountProfileForm",{default:function(e){x=e}},4),t.link("../components/ConfirmOwnerChangeWarningModal",{default:function(e){C=e}},5),t.link("../contexts/TranslationContext",{useTranslation:function(e){k=e}},6),t.link("../hooks/useForm",{useForm:function(e){y=e}},7),t.link("../contexts/SettingsContext",{useSetting:function(e){b=e}},8),t.link("../contexts/UserContext",{useUser:function(e){E=e}},9),t.link("../contexts/ToastMessagesContext",{useToastMessageDispatch:function(e){A=e}},10),t.link("../contexts/ServerContext",{useMethod:function(e){P=e}},11),t.link("../contexts/ModalContext",{useSetModal:function(e){S=e}},12),t.link("../hooks/useUpdateAvatar",{useUpdateAvatar:function(e){U=e}},13),t.link("../helpers/getUserEmailAddress",{getUserEmailAddress:function(e){T=e}},14);var F=function(e){var n=e.onSave,t=e.onCancel,r=e.title,a=e.text,_=e.isPassword,v=s(e,["onSave","onCancel","title","text","isPassword"]),w=k(),x=h(""),C=o(x,2),y=C[0],b=C[1],E=g((function(e){return b(e.currentTarget.value)}),[b]),A=g((function(){n(y),t()}),[y,n,t]);return p.createElement(d,v,p.createElement(d.Header,null,p.createElement(i,{color:"danger",name:"modal-warning",size:20}),p.createElement(d.Title,null,r),p.createElement(d.Close,{onClick:t})),p.createElement(d.Content,{fontScale:"p1"},p.createElement(c,{mb:"x8"},a),_&&p.createElement(m,{w:"full",value:y,onChange:E}),!_&&p.createElement(f,{w:"full",value:y,onChange:E})),p.createElement(d.Footer,null,p.createElement(l,{align:"end"},p.createElement(u,{ghost:!0,onClick:t},w("Cancel")),p.createElement(u,{primary:!0,danger:!0,onClick:A},w("Continue")))))},M=function(e){var n,t,r,a,o,s,l,u,c;return{realname:null!==(n=e.name)&&void 0!==n?n:"",email:null!==(t=T(e))&&void 0!==t?t:"",username:null!==(r=e.username)&&void 0!==r?r:"",password:"",confirmationPassword:"",avatar:"",url:null!==(a=e.avatarUrl)&&void 0!==a?a:"",statusText:null!==(o=e.statusText)&&void 0!==o?o:"",statusType:null!==(s=e.status)&&void 0!==s?s:"",bio:null!==(l=e.bio)&&void 0!==l?l:"",customFields:null!==(u=e.customFields)&&void 0!==u?u:{},nickname:null!==(c=e.nickname)&&void 0!==c?c:""}},O=function(){var e,n,t,s=k(),m=A(),f=E(),d=y(M(f)),O=d.values,D=d.handlers,R=d.hasUnsavedChanges,B=d.commit,N=h(!0),W=o(N,2),I=W[0],L=W[1],H=S(),j=h(!1),q=o(j,2),z=q[0],G=q[1],V=P("logoutOtherClients"),$=P("deleteUserOwnAccount"),J=P("saveUserProfile"),K=g((function(){return H(null)}),[H]),Q=Boolean(null==f?void 0:null===(e=f.services)||void 0===e?void 0:null===(n=e.password)||void 0===n?void 0:null===(t=n.bcrypt)||void 0===t?void 0:t.trim()),X=(O.email!==T(f)||!!O.password)&&Q,Y=b("Message_ErasureType"),Z=b("Accounts_AllowRealNameChange"),ee=b("Accounts_AllowUserStatusMessageChange"),ne=b("Accounts_AllowUsernameChange"),te=b("Accounts_AllowEmailChange"),re=b("Accounts_AllowPasswordChange"),ae=b("Accounts_AllowUserAvatarChange"),oe=b("Accounts_AllowDeleteOwnAccount"),se=b("LDAP_Enable"),le=b("Accounts_RequireNameForSignUp"),ue=b("UTF8_Names_Validation"),ce=v((function(){return new RegExp("^"+ue+"$")}),[ue]),ie=ne&&!se,me=v((function(){return{allowRealNameChange:Z,allowUserStatusMessageChange:ee,allowEmailChange:te,allowPasswordChange:re,allowUserAvatarChange:ae,allowDeleteOwnAccount:oe,canChangeUsername:ie,requireName:le,namesRegex:ce}}),[oe,te,re,Z,ae,ee,ie,le,ce]),fe=O.realname,de=O.email,_e=O.avatar,pe=O.username,ve=O.password,he=O.statusText,ge=O.statusType,we=O.customFields,xe=O.bio,Ce=O.nickname,ke=D.handleAvatar,ye=U(_e,f._id),be=g(function(){function e(){var e;return r.async(function(){function n(n){for(;;)switch(n.prev=n.next){case 0:if(e=function(){function e(e){var n;return r.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.awrap(ye());case 3:return(n=t.sent)&&ke(""),t.next=7,r.awrap(J(a({},Z&&{realname:fe},{},te&&T(f)!==de&&{email:de},{},re&&{password:ve},{},ie&&{username:pe},{},ee&&{statusText:he},{},e&&{typedPassword:_(e)},{statusType:ge,nickname:Ce,bio:xe||""}),we));case 7:B(),m({type:"success",message:s("Profile_saved_successfully")}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),m({type:"error",message:t.t0});case 14:case"end":return t.stop()}}return t}(),null,null,[[0,11]],Promise)}return e}(),!X){n.next=3;break}return n.abrupt("return",H((function(){return p.createElement(F,{onSave:e,onCancel:K,title:s("Please_enter_your_password"),text:s("For_your_security_you_must_enter_your_current_password_to_continue"),isPassword:!0})})));case 3:e();case 4:case"end":return n.stop()}}return n}(),null,null,null,Promise)}return e}(),[J,te,re,Z,ee,xe,ie,de,ve,fe,he,pe,f,ye,ke,K,X,m,s,we,ge,H,B,Ce]),Ee=g(function(){function e(){return r.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:return G(!0),e.prev=1,e.next=4,r.awrap(V());case 4:m({type:"success",message:s("Logged_out_of_other_clients_successfully")}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),m({type:"error",message:e.t0});case 10:G(!1);case 11:case"end":return e.stop()}}return e}(),null,null,[[1,7]],Promise)}return e}(),[V,m,s]),Ae=g(function(){function e(){var e,n;return r.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:if(e=function(){function e(e){var n,t,a;return r.async(function(){function o(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.awrap($(_(e)));case 3:m({type:"success",message:s("User_has_been_deleted")}),o.next=12;break;case 6:if(o.prev=6,o.t0=o.catch(0),"user-last-owner"!==o.t0.error){o.next=11;break}return n=o.t0.details,t=n.shouldChangeOwner,a=n.shouldBeRemoved,o.abrupt("return",H((function(){return p.createElement(C,{onConfirm:function(){$(_(e),!0)},onCancel:K,contentTitle:s("Delete_User_Warning_"+Y),confirmLabel:s("Continue"),shouldChangeOwner:t,shouldBeRemoved:a})})));case 11:m({type:"error",message:o.t0});case 12:case"end":return o.stop()}}return o}(),null,null,[[0,6]],Promise)}return e}(),n=s("Are_you_sure_you_want_to_delete_your_account"),!Q){t.next=4;break}return t.abrupt("return",H((function(){return p.createElement(F,{onSave:e,onCancel:K,title:n,text:s("For_your_security_you_must_enter_your_current_password_to_continue"),isPassword:!0})})));case 4:return t.abrupt("return",H((function(){return p.createElement(F,{onSave:e,onCancel:K,title:n,text:s("If_you_are_sure_type_in_your_username"),isPassword:!0})})));case 5:case"end":return t.stop()}}return t}(),null,null,null,Promise)}return e}(),[K,$,m,Y,Q,s,H]);return p.createElement(w,null,p.createElement(w.Header,{title:s("Profile")},p.createElement(l,null,p.createElement(u,{primary:!0,disabled:!R||!I||z,onClick:be},s("Save_changes")))),p.createElement(w.ScrollableContentWithShadow,null,p.createElement(c,{maxWidth:"600px",w:"full",alignSelf:"center"},p.createElement(x,{values:O,handlers:D,user:f,settings:me,onSaveStateChange:L}),p.createElement(l,{stretch:!0,mb:"x12"},p.createElement(u,{onClick:Ee,flexGrow:0,disabled:z},s("Logout_Others")),oe&&p.createElement(u,{danger:!0,onClick:Ae},p.createElement(i,{name:"trash",size:"x20",mie:"x4"}),s("Delete_my_account"))))))};t.exportDefault(O)}

