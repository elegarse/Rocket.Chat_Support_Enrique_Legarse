function module(e,n,t){var a,l,r,o,c,i,u,s,f,m,g,d,b,h,p,E,k,v,_,x,T;t.link("@babel/runtime/helpers/extends",{default:function(e){a=e}},0),t.link("@babel/runtime/regenerator",{default:function(e){l=e}},1),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){r=e}},2),t.link("react",{default:function(e){o=e},useState:function(e){c=e}},0),t.link("@rocket.chat/fuselage",{Box:function(e){i=e},Button:function(e){u=e},ButtonGroup:function(e){s=e},Field:function(e){f=e},FieldGroup:function(e){m=e},ToggleSwitch:function(e){g=e},Callout:function(e){d=e},Divider:function(e){b=e}},1),t.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(e){h=e}},2),t.link("../../components/basic/Page",{default:function(e){p=e}},3),t.link("../../components/PageSkeleton",{default:function(e){E=e}},4),t.link("../../contexts/TranslationContext",{useTranslation:function(e){k=e}},5),t.link("../../contexts/ToastMessagesContext",{useToastMessageDispatch:function(e){v=e}},6),t.link("../../contexts/ServerContext",{useMethodData:function(e){_=e},AsyncState:function(e){x=e},useMethod:function(e){T=e}},7);var w=[{action:"initialState"}],y=[{action:"list-pages"}],C=function(){var e=k(),n=v(),t=_("livechat:facebook",w),a=r(t,3),c=a[0],i=a[1],u=a[2],s=_("livechat:facebook",y),f=r(s,3),m=f[0],g=f[1],b=f[2],C=c||{enabled:!1,hasToken:!1},S=C.enabled,R=C.hasToken,P,F=(m||{pages:[]}).pages,N=T("livechat:facebook"),A=h(function(){function e(e,t,a){var r;return l.async(function(){function o(o){for(;;)switch(o.prev=o.next){case 0:return a(!t),o.prev=1,r=t?"unsubscribe":"subscribe",o.next=5,l.awrap(N({action:r,page:e}));case 5:o.next=11;break;case 7:o.prev=7,o.t0=o.catch(1),n({type:"error",message:o.t0}),a(t);case 11:case"end":return o.stop()}}return o}(),null,null,[[1,7]],Promise)}return e}()),I=h(function(){function t(){return l.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.awrap(N({action:"disable"}));case 3:n({type:"success",message:e("Integration_disabled")}),u(),b(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n({type:"error",message:t.t0});case 11:case"end":return t.stop()}}return t}(),null,null,[[0,8]],Promise)}return t}()),M=function(e,n){var t=window.open(e,"facebook-integration-oauth","width=600,height=400"),a=setInterval((function(){(null==t?void 0:t.closed)&&(clearInterval(a),n())}),300)},G=h(function(){function e(){var e;return l.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.awrap(N({action:"enable"}));case 3:(null==(e=t.sent)?void 0:e.url)?M(null==e?void 0:e.url,(function(){G()})):(u(),b()),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n({type:"error",message:t.t0});case 10:case"end":return t.stop()}}return t}(),null,null,[[0,7]],Promise)}return e}());return i===x.LOADING||g===x.LOADING?o.createElement(E,null):i===x.ERROR?o.createElement(p,null,o.createElement(p.Header,{title:e("Edit_Custom_Field")}),o.createElement(p.ScrollableContentWithShadow,null,o.createElement(d,{type:"danger"},e("Error")))):(S&&R&&g===x.ERROR&&G(),o.createElement(D,{pages:F,enabled:S,hasToken:R,onToggle:A,onRefresh:b,onDisable:I,onEnable:G}))},S=function(e){var n=e.name,t=e.id,a=e.subscribed,l=e.onToggle,u=e.className,s=c(a),m=r(s,2),d=m[0],b=m[1],p=h((function(){return l(t,d,b)}));return o.createElement(f,{className:u},o.createElement(i,{display:"flex",flexDirection:"row"},o.createElement(f.Label,null,n),o.createElement(f.Row,null,o.createElement(g,{checked:d,onChange:p}))))},R=function(e){var n=e.pages,t=e.onToggle,l=e.className;return(o.createElement(m,null,n.map((function(e){return o.createElement(S,a({key:e.id},e,{onToggle:t,className:l}))}))))},D=function(e){var n=e.pages,t=e.enabled,a=e.hasToken,l=e.onToggle,r=e.onRefresh,c=e.onEnable,f=e.onDisable,g=k();return o.createElement(p,null,o.createElement(p.Header,{title:g("Facebook")}),o.createElement(p.ScrollableContentWithShadow,null,o.createElement(i,{maxWidth:"x600",w:"full",alignSelf:"center"},!t&&o.createElement(o.Fragment,null,o.createElement(s,{stretch:!0,mb:"x8"},o.createElement(u,{primary:!0,onClick:c,disabled:!a},g("Enable"))),!a&&o.createElement(o.Fragment,null,o.createElement("p",null,g("You_have_to_set_an_API_token_first_in_order_to_use_the_integration")),o.createElement("p",null,g("Please_go_to_the_Administration_page_then_Livechat_Facebook")))),t&&o.createElement(o.Fragment,null,o.createElement(i,{fontScale:"h1",mbe:"x8"},g("Pages")),(null==n?void 0:n.length)?o.createElement(m,null,o.createElement(R,{pages:n,onToggle:l})):g("No_pages_yet_Try_hitting_Reload_Pages_button"),o.createElement(i,{w:"full",mb:"x16"},o.createElement(b,null)),o.createElement(s,{stretch:!0,vertical:!0},o.createElement(u,{onClick:r},g("Reload_Pages")),o.createElement(u,{danger:!0,onClick:f},g("Disable")))))))};t.exportDefault(C)}

