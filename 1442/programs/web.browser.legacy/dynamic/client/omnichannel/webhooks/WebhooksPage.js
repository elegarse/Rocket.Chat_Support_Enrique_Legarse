function module(e,t,n){var o,a,c,r,l,i,s,u,_,h,k,f,m,v,d,b,w,g,p,E,L,x,C,S,y,T;n.link("@babel/runtime/regenerator",{default:function(e){o=e}},0),n.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){a=e}},1),n.link("@babel/runtime/helpers/slicedToArray",{default:function(e){c=e}},2),n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){r=e}},3),n.link("react",{default:function(e){l=e},useMemo:function(e){i=e}},0),n.link("@rocket.chat/fuselage",{Box:function(e){s=e},Callout:function(e){u=e},FieldGroup:function(e){_=e},Field:function(e){h=e},TextInput:function(e){k=e},MultiSelect:function(e){f=e},Button:function(e){m=e},ButtonGroup:function(e){v=e}},1),n.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(e){d=e}},2),n.link("../../contexts/AuthorizationContext",{usePermission:function(e){b=e}},3),n.link("../../contexts/ServerContext",{useMethod:function(e){w=e}},4),n.link("../../contexts/ToastMessagesContext",{useToastMessageDispatch:function(e){g=e}},5),n.link("../../contexts/TranslationContext",{useTranslation:function(e){p=e}},6),n.link("../../hooks/useEndpointDataExperimental",{useEndpointDataExperimental:function(e){E=e},ENDPOINT_STATES:function(e){L=e}},7),n.link("../../hooks/useForm",{useForm:function(e){x=e}},8),n.link("../../components/basic/Page",{default:function(e){C=e}},9),n.link("../../components/basic/ExternalLink",{default:function(e){S=e}},10),n.link("../../components/PageSkeleton",{default:function(e){y=e}},11),n.link("../../components/NotAuthorizedPage",{default:function(e){T=e}},12);var A=function(e){return e.reduce((function(e,t){var n,o=t._id,a=t.value;return e=r({},e,((n={})[o]=a,n))}),{})},M=function(e){return Object.entries(e).reduce((function(e,t){var n=c(t,2),o=n[0],r;return n[1]&&(e=[].concat(a(e),[o])),e}),[])},O="https://rocket.chat/docs/administrator-guides/livechat/#integrations",P=function(){var e=p(),t=E("livechat/integrations.settings"),n=t.data,o=t.state,a=t.error,c;return b("view-livechat-webhooks")?o===L.LOADING?l.createElement(y,null):n&&n.success&&n.settings&&!a?l.createElement(D,{settings:A(n.settings)}):l.createElement(C,null,l.createElement(C.Header,{title:e("Webhooks")}),l.createElement(C.ScrollableContentWithShadow,null,l.createElement(u,{type:"danger"},e("Error")))):l.createElement(T,null)},U=function(e){var t=e.Livechat_webhookUrl,n=e.Livechat_secret_token,o=e.Livechat_webhook_on_start,a=e.Livechat_webhook_on_close,c=e.Livechat_webhook_on_chat_taken,r=e.Livechat_webhook_on_chat_queued,l=e.Livechat_webhook_on_forward,i=e.Livechat_webhook_on_offline_msg,s=e.Livechat_webhook_on_visitor_message,u=e.Livechat_webhook_on_agent_message,_,h;return{Livechat_webhookUrl:t,Livechat_secret_token:n,sendOn:M({Livechat_webhook_on_start:o,Livechat_webhook_on_close:a,Livechat_webhook_on_chat_taken:c,Livechat_webhook_on_chat_queued:r,Livechat_webhook_on_forward:l,Livechat_webhook_on_offline_msg:i,Livechat_webhook_on_visitor_message:s,Livechat_webhook_on_agent_message:u})}},D=function(e){var t=e.settings,n=p(),a=g(),u=x(U(t)),b=u.values,E=u.handlers,L=u.hasUnsavedChanges,y=u.reset,T=u.commit,A=w("livechat:saveIntegration"),M=w("livechat:webhookTest"),P=b.Livechat_webhookUrl,D=b.Livechat_secret_token,I=b.sendOn,R=E.handleLivechat_webhookUrl,W=E.handleLivechat_secret_token,q=E.handleSendOn,F=i((function(){return[["Livechat_webhook_on_start",n("Chat_start")],["Livechat_webhook_on_close",n("Chat_close")],["Livechat_webhook_on_chat_taken",n("Chat_taken")],["Livechat_webhook_on_chat_queued",n("Chat_queued")],["Livechat_webhook_on_forward",n("Forwarding")],["Livechat_webhook_on_offline_msg",n("Offline_messages")],["Livechat_webhook_on_visitor_message",n("Visitor_message")],["Livechat_webhook_on_agent_message",n("Agent_messages")]]}),[n]),N=d(function(){function e(){var e;return o.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return e=F.reduce((function(e,t){var n,o,a=c(t,1)[0];return e=r({},e,((n={})[a]=I.includes(a)?1:0,n))}),{}),t.prev=1,t.next=4,o.awrap(A(r({Livechat_webhookUrl:P,Livechat_secret_token:D},e)));case 4:a({type:"success",message:n("Saved")}),T(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),a({type:"error",message:t.t0});case 11:case"end":return t.stop()}}return t}(),null,null,[[1,8]],Promise)}return e}()),j=d(function(){function e(){return o.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.awrap(M());case 3:a({type:"success",message:n("It_works")}),T(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),a({type:"error",message:e.t0});case 10:case"end":return e.stop()}}return e}(),null,null,[[0,7]],Promise)}return e}());return l.createElement(C,null,l.createElement(C.Header,{title:n("Webhooks")},l.createElement(v,null,l.createElement(m,{onClick:function(){return y()}},n("Reset")),l.createElement(m,{onClick:j,disabled:!P||L},n("Send_Test")),l.createElement(m,{primary:!0,onClick:N,disabled:!L},n("Save")))),l.createElement(C.ScrollableContentWithShadow,null,l.createElement(s,{maxWidth:"x600",w:"full",alignSelf:"center"},l.createElement("p",null,n("You_can_use_webhooks_to_easily_integrate_livechat_with_your_CRM")),l.createElement("p",null,l.createElement(S,{to:O},n("Click_here"))," ",n("to_see_more_details_on_how_to_integrate")),l.createElement(_,null,l.createElement(h,null,l.createElement(h.Label,null,n("Webhook_URL")),l.createElement(h.Row,null,l.createElement(k,{value:P,onChange:R,placeholder:"https://yourdomain.com/webhook/entrypoint"}))),l.createElement(h,null,l.createElement(h.Label,null,n("Secret_token")),l.createElement(h.Row,null,l.createElement(k,{value:D,onChange:W,placeholder:n("Secret_token")}))),l.createElement(h,null,l.createElement(h.Label,null,n("Send_request_on")),l.createElement(h.Row,null,l.createElement(s,{w:"full",display:"flex",alignItems:"stretch",justifyContent:"stretch"},l.createElement(f,{w:"full",value:I,onChange:q,options:F,placeholder:n("Select_an_option")}))))))))};n.exportDefault(P)}

