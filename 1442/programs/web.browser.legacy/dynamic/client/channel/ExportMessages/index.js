function module(e,t,n){var l,a,r,o,c,s,u,i,m,f,d,E,p,h,b,_,g,k,C,v,x,w,T,M,y,L,S,F;function R(){var e=o(["\n\tcursor: pointer;\n"]);return R=function(){return e},e}n.link("@babel/runtime/helpers/slicedToArray",{default:function(e){l=e}},0),n.link("@babel/runtime/regenerator",{default:function(e){a=e}},1),n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){r=e}},2),n.link("@babel/runtime/helpers/taggedTemplateLiteralLoose",{default:function(e){o=e}},3),n.export({ExportMessages:function(){return B}}),n.link("react",{default:function(e){c=e},useState:function(e){s=e},useEffect:function(e){u=e},useMemo:function(e){i=e}},0),n.link("@rocket.chat/fuselage",{Field:function(e){m=e},TextInput:function(e){f=e},Select:function(e){d=e},ButtonGroup:function(e){E=e},Button:function(e){p=e},Box:function(e){h=e},Icon:function(e){b=e},Callout:function(e){_=e},FieldGroup:function(e){g=e}},1),n.link("@rocket.chat/css-in-js",{css:function(e){k=e}},2),n.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(e){C=e}},3),n.link("toastr",{default:function(e){v=e}},4),n.link("../../components/basic/VerticalBar",{default:function(e){x=e}},5),n.link("../../components/basic/AutoComplete",{UserAutoComplete:function(e){w=e}},6),n.link("../../contexts/TranslationContext",{useTranslation:function(e){T=e}},7),n.link("../../hooks/useForm",{useForm:function(e){M=e}},8),n.link("../hooks/useUserRoom",{useUserRoom:function(e){y=e}},9),n.link("../../contexts/ServerContext",{useEndpoint:function(e){L=e}},10),n.link("../../../app/utils",{roomTypes:function(e){S=e},isEmail:function(e){F=e}},11);var j=k(R()),D=function(e){var t=e.onCancel,n=e.rid,l=T(),o=M({dateFrom:"",dateTo:"",format:"html"}),s=o.values,u=o.handlers,h=s.dateFrom,b=s.dateTo,_=s.format,k=u.handleDateFrom,C=u.handleDateTo,x=u.handleFormat,w=i((function(){return[["html",l("HTML")],["json",l("JSON")]]}),[l]),y=L("POST","rooms.export"),S=function(){function e(){return a.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.awrap(y(r({rid:n,type:"file"},h&&{dateFrom:new Date(h)},{},b&&{dateTo:new Date(b)},{format:_})));case 3:return v.success(l("Your_email_has_been_queued_for_sending")),e.abrupt("return");case 7:e.prev=7,e.t0=e.catch(0),v.error(l("Error"));case 10:case"end":return e.stop()}}return e}(),null,null,[[0,7]],Promise)}return e}();return c.createElement(g,null,c.createElement(m,null,c.createElement(m.Label,null,l("Date_From")),c.createElement(m.Row,null,c.createElement(f,{type:"date",value:h,onChange:k}))),c.createElement(m,null,c.createElement(m.Label,null,l("Date_to")),c.createElement(m.Row,null,c.createElement(f,{type:"date",value:b,onChange:C}))),c.createElement(m,null,c.createElement(m.Label,null,l("Output_format")),c.createElement(m.Row,null,c.createElement(d,{value:_,onChange:x,placeholder:l("Format"),options:w}))),c.createElement(E,{stretch:!0,mb:"x12"},c.createElement(p,{onClick:t},l("Cancel")),c.createElement(p,{primary:!0,onClick:function(){return S()}},l("Export"))))},U=function(e){var t=e.onCancel,n=e.rid,r=T(),o=y(n),i=o&&o.t&&S.getRoomName(o.t,o),d=s([]),k=l(d,2),x=k[0],R=k[1],D=s(),U=l(D,2),B=U[0],P=U[1],A=M({dateFrom:"",dateTo:"",toUsers:"",additionalEmails:"",subject:r("Mail_Messages_Subject",i)}),N=A.values,O=A.handlers,I=N.toUsers,q=N.additionalEmails,z=N.subject,G=C((function(e){return R(x.concat(e))})),H=C((function(e){return R(x.filter((function(t){return t!==e})))})),Y=C((function(){R([]),$("#chat-window-"+n+".messages-box .message.selected").removeClass("selected")}));u((function(){var e=$("#chat-window-"+n);$(".messages-box",e).addClass("selectable");var t=function(){var e=this.id;this.classList.contains("selected")?(this.classList.remove("selected"),H(e)):(this.classList.add("selected"),G(e))};return $(".messages-box .message",e).on("click",t),function(){$(".messages-box",e).removeClass("selectable"),$(".messages-box .message",e).off("click",t).filter(".selected").removeClass("selected")}}),[n]);var J=O.handleToUsers,V=O.handleAdditionalEmails,K=O.handleSubject,Q=L("POST","rooms.export"),W=function(){function e(){return a.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:if(0!==I.length||""!==q){e.next=3;break}return P(r("Mail_Message_Missing_to")),e.abrupt("return");case 3:if(""===q||F(q)){e.next=6;break}return P(r("Mail_Message_Invalid_emails",q)),e.abrupt("return");case 6:if(0!==x.length){e.next=9;break}return P(r("Mail_Message_No_messages_selected_select_all")),e.abrupt("return");case 9:return P(null),e.prev=10,e.next=13,a.awrap(Q({rid:n,type:"email",toUsers:[I],toEmails:q.split(","),subject:z,messages:x}));case 13:return v.success(r("Your_email_has_been_queued_for_sending")),e.abrupt("return");case 17:e.prev=17,e.t0=e.catch(10),v.error(r("Error"));case 20:case"end":return e.stop()}}return e}(),null,null,[[10,17]],Promise)}return e}();return c.createElement(g,null,c.createElement(m,null,c.createElement(_,{onClick:Y,title:r("Messages selected"),type:x.length>0?"success":"info"},c.createElement("p",null,x.length+" Messages selected"),x.length>0&&c.createElement(h,{is:"p",className:j},r("Click here to clear the selection")),0===x.length&&c.createElement(h,{is:"p"},r("Click_the_messages_you_would_like_to_send_by_email")))),c.createElement(m,null,c.createElement(m.Label,null,r("To_users")),c.createElement(m.Row,null,c.createElement(w,{value:I,onChange:J}))),c.createElement(m,null,c.createElement(m.Label,null,r("To_additional_emails")),c.createElement(m.Row,null,c.createElement(f,{placeholder:r("Email_Placeholder_any"),value:q,onChange:V,addon:c.createElement(b,{name:"mail",size:"x20"})}))),c.createElement(m,null,c.createElement(m.Label,null,r("Subject")),c.createElement(m.Row,null,c.createElement(f,{value:z,onChange:K,addon:c.createElement(b,{name:"edit",size:"x20"})}))),B&&c.createElement(_,{type:"danger",title:B}),c.createElement(E,{stretch:!0,mb:"x12"},c.createElement(p,{onClick:t},r("Cancel")),c.createElement(p,{primary:!0,onClick:function(){return W()}},r("Send"))))},B=function(){function e(e){var t=e.rid,n=e.tabBar,a=T(),r=s("email"),o=l(r,2),u=o[0],f=o[1],E=i((function(){return[["email",a("Send_via_email")],["file",a("Export_as_file")]]}),[a]);return c.createElement(x,null,c.createElement(x.Header,null,a("Export_Messages"),c.createElement(x.Close,{onClick:function(){return n.close()}})),c.createElement(x.ScrollableContent,null,c.createElement(g,null,c.createElement(m,null,c.createElement(m.Label,null,a("Method")),c.createElement(m.Row,null,c.createElement(d,{value:u,onChange:function(e){return f(e)},placeholder:a("Type"),options:E})))),u&&"file"===u&&c.createElement(D,{rid:t,onCancel:function(){return n.close()}}),u&&"email"===u&&c.createElement(U,{rid:t,onCancel:function(){return n.close()}})))}return e}();n.exportDefault(B)}

